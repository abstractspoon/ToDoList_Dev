<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="window_control_version_1.0_files/filelist.xml">
<title>Window Control version 1.0</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>PWINKLER</o:Author>
  <o:LastAuthor>PWinkler</o:LastAuthor>
  <o:Revision>7</o:Revision>
  <o:TotalTime>36</o:TotalTime>
  <o:Created>2001-01-22T10:02:00Z</o:Created>
  <o:LastSaved>2002-01-11T22:54:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1706</o:Words>
  <o:Characters>9727</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>81</o:Lines>
  <o:Paragraphs>22</o:Paragraphs>
  <o:CharactersWithSpaces>11411</o:CharactersWithSpaces>
  <o:Version>10.3131</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h2
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
code
	{font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:821115345;
	mso-list-type:hybrid;
	mso-list-template-ids:-1866566156 -1312935184 -1446457076 1266429776 -2116505174 1932939010 -1849379124 1149643002 2108168428 1425541272;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:867376379;
	mso-list-template-ids:987521282;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
<meta http-equiv=Author content="Patrick Winkler (PWinkler)">
</head>

<body lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<h1>Summary</h1>

<p>The window control is meant as a tool to automate control of windows through
script, including move, resizing, clicking buttons, and pressing keys. It is a
simple control to give relatively low-level access to the Win32 windows API
functions within scripting engines that support COM components.</p>

<h1>&nbsp;</h1>

<h1>Purpose</h1>

<p>This control should enable users to write scripts that can automatically do
custom installations involving GUI driven installs (i.e. wizards) or interface
level testing.</p>

<h1>&nbsp;</h1>

<h1>Usage</h1>

<p>The usage of the windows control directly reflects the Win32 APIs that it is
using behind the scenes. It also roughly emulates the functionality of form in
Visual BASIC.</p>

<p>Typically, the use of the window control will entail clicking a button or
entering text in a control.&nbsp; For most every scenario, 2 steps are taken:
Find the control and then perform an action on it.</p>

<p>To find the control you want to manipulate, start at the desktop window (the
window with WindowHandle = 0), and search downward through the window
hierarchy.&nbsp; For example, to get the next button on the WMFSDK install
dialog, one would start at the desktop (the default for a newly created window
control) and search for a subwindow with the title of the dialog, &quot;Windows
Media Format SDK 7 Setup&quot; using the <b><a href="#GetSubwindowWithTitle">GetSubwindowWithTitle</a></b>
method.&nbsp; Once found, one can find the subwindow that is the next button by
searching for &quot;&amp;<span class=GramE>Next</span>&quot;, again using <b><a
href="#GetSubwindowWithTitle">GetSubwindowWithTitle</a></b>.&nbsp; The reason the
&quot;&amp;&quot; is there is that windows marks the keyboard accelerator keys
by preceding them with the &quot;&amp;&quot; symbol.&nbsp; This causes the
&quot;N&quot; in &quot;Next&quot; to be underlined and hitting Alt-N will click
the next button.</p>

<p>To perform an action on the control is simple once you have a reference to
it;&nbsp;just call the appropriate action method.&nbsp; For example, to
simulate a mouse click, use the <b><a href="#ButtonClick">ButtonClick</a></b>
method.</p>

<h1>Examples</h1>

<p>The following code snippet will run the WMFSDK v.8, and click the next
button:</p>

<table class=MsoNormalTable border=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0'>
  <td width="54%" style='width:54.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><b><u>Code</u></b></p>
  </td>
  <td width="46%" style='width:46.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><b><u>Description</u></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width="54%" style='width:54.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;color:green'>' Get scripting
  object</span><span style='font-size:7.5pt'><br>
  Set wshell = <span class=GramE>CreateObject(</span> <span style='color:navy'>&quot;WScript.Shell&quot;</span>
  )<br>
  <br>
  <span style='color:green'>' Get reference to the desktop</span><br>
  Set window = CreateObject( <span style='color:navy'>&quot;WindowsControl.Window&quot;</span>
  )<br>
  <br>
  <span style='color:green'>' Run setup program</span><br>
  wshell.Run <span style='color:navy'>&quot;\\icecube\latest_wmwiz\us\i386\release\FREE\wmp.exe&quot;</span><br>
  <br>
  <span style='color:green'>' Wait for window to appear</span><br>
  bWindowFound = <span style='color:navy'>false</span><br>
  While not bWindowFound<br>
  &nbsp;&nbsp;&nbsp;<span style='color:green'> ' Search for the WMP install
  window</span><br>
  &nbsp;&nbsp;&nbsp; Set installWindow = window.<a href="#GetSubwindowWithTitle"><span
  class=GramE>GetSubwindowWithTitle</span></a>( <span style='color:navy'>&quot;Windows
  Media Component Setup&quot;</span> )<br>
  <br>
  &nbsp;&nbsp;&nbsp; If installWindow.<a href="#WindowHandle">WindowHandle</a>
  &lt;&gt; <span style='color:navy'>0</span> Then<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bWindowFound = <span
  style='color:navy'>true</span><br>
  &nbsp;&nbsp;&nbsp; End If<br>
  &nbsp;&nbsp;&nbsp; WScript.Sleep <span style='color:navy'>1000</span> <span
  style='color:green'>' Wait 1 second for window to pop up</span><br>
  Wend<br>
  <br>
  <span style='color:green'>' Get reference to the &quot;next&quot; button</span><br>
  Set btnNext = installWindow.<a href="#GetSubwindowWithTitle"><span
  class=GramE>GetSubwindowWithTitle</span></a>( <span style='color:navy'>&quot;&amp;Next
  &gt;&quot;</span> )<br>
  <br>
  <span style='color:green'>' Click &quot;next&quot; button&nbsp;</span><br>
  bEnabled = btnNext.<a href="#Enabled">Enabled</a><br>
  While (not bEnabled)<br>
  &nbsp;&nbsp;&nbsp; wscript.Sleep <span style='color:navy'>500</span> <span
  style='color:green'>' Wait 1/2 second for next button to be enabled</span><br>
  &nbsp;&nbsp;&nbsp; bEnabled = btnNext.<a href="#Enabled">Enabled</a><br>
  Wend<br>
  <br>
  <span style='color:green'>' Click next button</span><br>
  btnNext.<a href="#ButtonClick">ButtonClick</a> <span style='color:navy'>0</span>,
  <span style='color:navy'>0</span>, <span style='color:navy'>0</span>&nbsp;</span></p>
  </td>
  <td width="46%" style='width:46.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Steps: </p>
  <ol start=1 type=1>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Create a shell object,
       so that we can run the setup program with its Run method.</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Create a window
       object, which defaults to controlling the desktop.&nbsp; All application
       windows are subwindows of the desktop, so from there it is possible to
       get a reference to the install program's window.</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Run the setup using the
       shell object.</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Wait for the install
       window to appear.&nbsp; This loop searches for the install window every
       second until it finds it.&nbsp; This uses the fact that a window
       defaults to the desktop, giving it a window handle == 0, to determine if
       the window was found.&nbsp; If the window handle is not equal to 0, then
       the correct window has been found.&nbsp;</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Get the next
       button.&nbsp; This uses the text on the button (the button's
       &quot;title&quot;) to locate it.</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Wait for the next
       button to be enabled.&nbsp; This checks to see if the next button is
       enabled every 1/2 second (500 milliseconds).</li>
   <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
       auto;mso-list:l0 level1 lfo3;tab-stops:list .5in'>Click the next button
       at location (0, 0) with no keys pressed.</li>
  </ol>
  </td>
 </tr>
</table>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'>&nbsp;</p>

<h1>Functionality</h1>

<p>The functionality of the control is divided into 3 parts: <a
href="#Locating_Windows">Locating windows</a>, <a href="#Properties">Properties</a>,
and <a href="#Actions">Actions</a>.</p>

<h2><a name="Locating_Windows">Locating Windows</a></h2>

<p>To control a particular window, the control’s <b>WindowHandle</b> property
must be equal to that window’s window handle. This is generally not done by
hand, except to point the window to the desktop. Instead, this is accomplished
through the followed methods on the window control:</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=GetSubwindowWithID></a><span class=GramE><span style='mso-bookmark:
GetSubwindowWithID'><b>GetSubwindowWithID</b></span><b>(</b></span><b> ID )</b>
– Given a sub window’s ID, will return an instance of a window control for the
subwindow. This is probably the most reliable way to get a subwindow, but
getting the window ID could be somewhat of a hassle. </p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=GetSubwindowWithTitle></a><span class=GramE><span
style='mso-bookmark:GetSubwindowWithTitle'><b>GetSubwindowWithTitle</b></span><b>(</b></span><b>
Title )</b> – Given the title (a.k.a. window text) of a sub window, will return
an instance of a window control for the subwindow. This is the recommended way
to find a subwindow, as it is the easiest to do. If two subwindows have the
same title, then this will return the first of the two windows.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Subwindow></a><span class=GramE><span style='mso-bookmark:Subwindow'><b>Subwindow</b></span><b>(</b></span><b>
index )</b> – Given the index of the subwindow, will return an instance of a
window control for the subwindow. This is mainly used in conjuction with the <b><a
href="#SubwindowCount">SubwindowCount</a></b> property to iterate through all
the subwindows of a given window.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=WindowHandle><b>WindowHandle</b></a> - This property is what
associates a window control with the actual window.&nbsp; If you somehow know
the handle of the control, you can set this directly and avoid traversing the
window hierarchy.&nbsp; If this value is changed, the window object will
manipulate a different window.&nbsp; This property is unique in that, if you
change this value, it doesn't actually change the window handle of the window,
but rather what window the control will manipulate.&nbsp; Generally one doesn't
mess with this value.</p>

<h2><a name=Properties>Properties</a></h2>

<p>This area covers various attributes of the window, including title and
position. </p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=ID><b>ID</b></a> - This is the ID of the window.&nbsp; This
property is only really useful if later you use the <b><a
href="#GetSubwindowWithID">GetSubwindowWithID</a> </b>method.<b> </b>&nbsp;
This property is read-only.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Enabled><b>Enabled</b></a> -True if the window is enabled, false
otherwise.&nbsp; When disabled, a window does not receive messages.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Height><b>Height</b></a> - The height of the window in pixels.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=ParentWindow></a><span class=GramE><span style='mso-bookmark:
ParentWindow'><b>ParentWindow</b></span> - The parent window of this window.</span>&nbsp;
This allows you travel up the window hierarchy.&nbsp;
window.Subwindow(X).ParentWindow = window for all valid numbers X</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Text><b>Text</b></a> - This is the text (a.k.a. title) of the
window</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Visible><b>Visible</b></a> - True if the window is visible, false
otherwise.&nbsp; When a window is not visible, the window does not show
onscreen.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Width><b>Width</b></a> - The width of the window in pixels.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=X><b>X</b></a> - The X <span class=GramE>coordinate</span> of the
top-left corner of the window.&nbsp; This can also be thought of as the left
edge of the window.&nbsp; This value is relative to the parent window.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Y><b>Y</b></a> - The Y <span class=GramE>coordinate</span> of the
top-left corner of the window.&nbsp; This can also be thought of as the top
edge of the window.&nbsp; This value is relative to the parent window.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=SubwindowCount><b>SubwindowCount</b></a> - The number of windows
that are contained in this window.&nbsp; This is usually used in <span
class=GramE>a for</span> loop with the <a href="#Subwindow">Subwindow</a>
method to get information about all the subwindows.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><b>Active</b> – True if the window will receive key presses.<span
style='mso-spacerun:yes'>  </span>Setting this value to true will move the
window to the front of the desktop, and cause it to receive key presses.<span
style='mso-spacerun:yes'>  </span>This would be just as if the <a
href="#Activate">Activate</a> method was called.<span
style='mso-spacerun:yes'>  </span>Setting it to false will cause the desktop to
receive key presses.</p>

<h2><a name=Actions>Actions</a></h2>

<p>These are things that can be done to the window, like click the mouse button
on it, activating it, or pressing a key.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=Activate><b>Activate</b></a> - This makes the window the
currently active window and sets it as the foreground window.&nbsp; This means
that any key presses afterwards will be directed to this window instead of
whatever window previously had focus.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=ButtonClick><b>ButtonClick</b></a><span class=GramE><b>( X</b></span><b>,
Y, Key )</b> - This action simulates a left mouse button click on the
window.&nbsp; This is mostly useful for button controls or checkboxes.&nbsp;
The <u>X</u> and <u>Y</u> arguments are the location on the window, relative to
the top left corner, that the mouse was clicked.&nbsp; The <u>key</u> argument
is the keycode that is sent with the button click, to simulate if the shift,
alt, or control keys are held down when the click occurred.&nbsp; Typically all
three arguments are 0.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=MoveWindow><b>MoveWindow</b></a><span class=GramE><b>( X</b></span><b>,
Y, Width, Height )</b> - This can move the location of the window or change the
height of the window.&nbsp; This is closely related to the <b>X</b>, <b>Y</b>, <b>Width</b>,
and <b>Height</b> properties.&nbsp; This function allows all of these values to
be changed simultaneously, but generally it's easier to use the properties than
the <b>MoveWindow</b> method.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=PostMessage></a><span class=GramE><span style='mso-bookmark:PostMessage'><b>PostMessage</b></span><b>(</b></span><b>
message, wParam, lParam )</b> - This message is a catch-all used to send the
window a message that is not supported through the window control's methods or
properties.&nbsp; Usage of this method requires knowledge of the windows
messaging system and should be avoided if possible.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><a name=SendChar></a><span class=GramE><span style='mso-bookmark:SendChar'><b>SendChar</b></span><b>(</b></span><b>
string, keycode )</b> - This action allows a sequence of keys to be sent to the
window as separate simulated key presses.&nbsp; The <u>string</u> argument is
the sequence of characters to be sent, and the <u>keycode</u> argument is used
to simulate if the shift, alt, or control keys are held down when the keys are
pressed.<span style='mso-spacerun:yes'>  </span>It is likely that only the
“alt” code (0x01000000 = 16777216) will work here.</p>

<p style='margin-top:5.0pt;margin-right:.5in;margin-bottom:5.0pt;margin-left:
.5in'><b>Close</b> - Closes the window.<span style='mso-spacerun:yes'> 
</span>Calling this function will act as if the close button on the window was
clicked.</p>

<p>&nbsp;</p>

<h1>Tips</h1>

<p>Clicking an item in the menu bar</p>

<p style='margin-left:.5in'>Clicking an item in the menu bar involves sending
the WM_COMMAND message to the window with that menu item.<span
style='mso-spacerun:yes'>  </span>To do this, use the <a href="#PostMessage">PostMessage</a>
method.<span style='mso-spacerun:yes'>  </span>The WM_COMMAND message is 273
(0x0111).<span style='mso-spacerun:yes'>  </span>As the wParam, send the
control ID for the menu item that is being selected.<span
style='mso-spacerun:yes'>  </span>For the lParam, use 0.</p>

<p style='margin-left:.5in'><span class=GramE>To get the wParam for the menu
item, use spy++ (available with VC++) to monitor the program for the WM_COMMAND
message.</span><span style='mso-spacerun:yes'>  </span>Then click the desired
menu item in the program.<span style='mso-spacerun:yes'>  </span>Go back to
spy++ and find the wParam for the WM_COMMAND message that corresponds to your
selection.<span style='mso-spacerun:yes'>  </span>The line will look something
like: “&lt;00005&gt; 010E053C P WM_COMMAND wNotifyCode<span class=GramE>:0</span>
(<span class=GramE>sent</span> from a menu) wID: 27”.<span
style='mso-spacerun:yes'>  </span>In this case “27” is the control ID.</p>

<p>Selecting a tab on a tab control</p>

<p style='margin-left:.5in'>While it is possible to change which tab looks
selected, it does not change which tab is <i>actually</i> selected.<span
style='mso-spacerun:yes'>  </span>This is possible through the <code><span
style='mso-ansi-font-size:12.0pt;mso-bidi-font-size:12.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"Times New Roman"'>TCM_SETCURSEL (4876 = 0x130C)
message.<span style='mso-spacerun:yes'>  </span>Calling the </span></code><a
href="#PostMessage">PostMessage</a> method with message 4876, wParam = the tab to
select (Starting with 0), and lParam = 0.</p>

<p style='margin-left:.5in'>The reason this can not effectively be done can be
seen in the MSDN documentation.<span style='mso-spacerun:yes'>  </span>In the
remarks section for the TCM_SETCURSEL message, “A tab control does not send a
TCN_SELCHANGING or TCN_SELCHANGE notification message when a tab is selected
using this message”.<span style='mso-spacerun:yes'>   </span>Both the
TCN_SELCHANGING and TCN_SELCHANGE notification messages, which would correctly
notify the application to change the tab, require lParam to be a pointer to an
NMHDR structure, which cannot be done through the window control.</p>


<p><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
