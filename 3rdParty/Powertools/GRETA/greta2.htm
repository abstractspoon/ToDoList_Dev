<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="greta2_files/filelist.xml">
<title>The GRETA Regular Expression Template Archive for C++</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="date" downloadurl=""/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PersonName" downloadurl="http://www.microsoft.com"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Eric Niebler</o:Author>
  <o:LastAuthor>Eric Niebler</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>8</o:TotalTime>
  <o:LastPrinted>1999-03-30T21:24:00Z</o:LastPrinted>
  <o:Created>2003-06-09T23:20:00Z</o:Created>
  <o:LastSaved>2003-06-09T23:20:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>9707</o:Words>
  <o:Characters>55330</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>461</o:Lines>
  <o:Paragraphs>129</o:Paragraphs>
  <o:CharactersWithSpaces>64908</o:CharactersWithSpaces>
  <o:Version>11.5207</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131077"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131078"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"?l?r ??fc";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-alt:"?l?r ???????";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-alt:Tahoma;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;
	mso-bidi-language:HE;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	mso-bidi-language:HE;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;
	mso-bidi-language:HE;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	tab-stops:right dotted 431.5pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;
	mso-no-proof:yes;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-vertical-page-align:middle;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
@page Section2
	{size:8.5in 11.0in;
	margin:1.0in 81.0pt 1.0in 81.0pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section2
	{page:Section2;}
 /* List Definitions */
 @list l0
	{mso-list-id:596907107;
	mso-list-type:hybrid;
	mso-list-template-ids:-1255741260 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:1416588604;
	mso-list-type:hybrid;
	mso-list-template-ids:-1402957358 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:1480028743;
	mso-list-type:hybrid;
	mso-list-template-ids:-1628524750 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3
	{mso-list-id:1487549466;
	mso-list-type:hybrid;
	mso-list-template-ids:713568340 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4
	{mso-list-id:1695959803;
	mso-list-type:hybrid;
	mso-list-template-ids:-1628524750 -1605174762 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:+;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='text-align:center'><a name="_Toc39890864">GRETA: <br
clear=all>
The GRETA Regular Expression Template Archive</a> </h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'>Copyright <a
href="mailto:ericne@microsoft.com?subject=greta%20gripe">Eric Niebler</a>, 2002</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The purpose of this document is to describe how to use the
GRETA Regular Expression Template Archive.<span style='mso-spacerun:yes'> 
</span>It describes the objects in the library, the methods defined on the
objects, and the ways to use the objects and methods to perform regular
expression pattern matching on strings in C++.<span style='mso-spacerun:yes'> 
</span>It does not describe regular expression syntax.<span
style='mso-spacerun:yes'>  </span>It is enough to say that the full Perl 5
syntax is supported.<span style='mso-spacerun:yes'>  </span>If you are not
familiar with Perl’s regular expression syntax, I recommend reading Chapter 2
of <u>Programming Perl, 2<sup>nd</sup> Ed.</u> (a.k.a. The Camel Book), one of
the many fine books put out by O’Reilly publishers.<span
style='mso-spacerun:yes'>  </span></p>

</div>

<span style='font-size:12.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:HE'><br clear=all style='page-break-before:always;mso-break-type:
section-break'>
</span>

<div class=Section2>

<p class=MsoToc1><!--[if supportFields]><span style='font-size:11.0pt'><span
style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>TOC \o &quot;1-3&quot; \h \z <span
style='mso-element:field-separator'></span></span><![endif]--><span
class=MsoHyperlink><a href="#_Toc39890864">GRETA:<span
style='mso-spacerun:yes'>  </span>The GRETA Regular Expression Template Archive<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890864 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890865">Overview<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890865 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>3</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890866">A Word about
Speed<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890866 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>4</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890867">Notice to
Users of Version 1.x<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890867 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>5</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890868">The rpattern
Object<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890868 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>5</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890869">rpattern::string_type<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890869 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800360039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890870">rpattern::rpattern<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890870 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890871">rpattern::match<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890871 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>7</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890872">rpattern::substitute<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890872 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>8</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890873">rpattern::count<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890873 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890874">rpattern::split<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890874 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890875">rpattern::set_substitution<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890875 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890876">rpattern::cgroups<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890876 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890877">match_results,
subst_results and split_results<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890877 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890878">match_results::cbackrefs<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890878 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890879">match_results::backref<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890879 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800370039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890880">match_results::rstart<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890880 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890881">match_results::rlength<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890881 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890882">match_results::all_backrefs<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890882 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890883">subst_results::backref_str<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890883 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890884">split_results::strings<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890884 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890885">The Syntax
Module<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890885 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>12</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890886">register_intrinsic_charset<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890886 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>14</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890887">Customizing
Your Search<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890887 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>14</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890888">NOCASE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890888 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890889">GLOBAL<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890889 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890890">MULTILINE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890890 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890891">SINGLELINE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890891 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890892">EXTENDED<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890892 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890893">RIGHTMOST<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890893 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890894">NOBACKREFS<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890894 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890895">ALLBACKREFS<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890895 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>16</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890896">FIRSTBACKREFS<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890896 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>16</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890897">NORMALIZE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890897 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>16</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890898">Matching
Modes<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890898 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>16</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890899">MODE_FAST<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890899 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003800390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890900">MODE_SAFE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890900 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890901">MODE_MIXED<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890901 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890902">Known Issues
and Perl Incompatibilities<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890902 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890903">Embedded
Code in a Regular Expression<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890903 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890904">Pattern
Modifier Scope<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890904 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>17</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890905">Comment
Blocks Before Quantifiers<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc39890905 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>18</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890906">Variable
Width Look-Behind Assertions<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890906 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>18</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890907">Recursive
Patterns<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890907 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>18</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890908">Compile-Time
Switches<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890908 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890909"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_WIDE_AND_NARROW</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890909 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900300039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890910"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_POSIX</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890910 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890911"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_NO_PERL</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890911 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890912"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_DEBUG</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890912 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890913"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_DEBUG_HEAP</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890913 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890914"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_STACK_ALIGNMENT</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890914 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890915"><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA'>REGEX_FOLD_INSTANTIATIONS</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890915 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>20</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890916">REGEX_TO_INSTANTIATE<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890916 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>20</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890917">Miscellaneous<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890917 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>20</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890918">Static
Const Patterns<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890918 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>20</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890919">Thread-safety<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890919 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>21</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890920">Stack
Usage<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890920 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>21</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890921">DBCS<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890921 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890922">STL<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890922 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890923">VC7
and Managed Code<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890923 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890924">Template
Instantiation<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890924 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 449.5pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc39890925">Contact
Information<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890925 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>23</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-bidi-language:AR-SA;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890926">Appendix 1:
History<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890926 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>24</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc39890927">Appendix 2:
Implementation Details<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc39890927 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>27</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330039003800390030003900320037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='mso-bidi-language:AR-SA'><o:p></o:p></span></p>

<p class=MsoNormal><!--[if supportFields]><span style='font-size:11.0pt'><span
style='mso-element:field-end'></span></span><![endif]--><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc39890865">Overview</a></h1>

<p class=MsoNormal>The regular expression template library contains objects and
functions that make it possible to perform pattern matching and substitution on
strings in C++.<span style='mso-spacerun:yes'>  </span>They are:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l0 level1 lfo1;tab-stops:list .5in'><span
     style='font-family:"Courier New"'>rpattern</span>: the pattern to use
     during the search.</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo1;tab-stops:list .5in'><span
     style='font-family:"Courier New"'>match_results/subst_results</span>:
     container for the results of a match/substitution. </li>
</ul>

<p class=MsoNormal>To perform a search or replace operation, you will typically
first initialize an <span style='font-family:"Courier New"'>rpattern</span>
object by giving it a string representing the pattern against which to
match.<span style='mso-spacerun:yes'>  </span>You will then call a method on
the rpattern object (<span style='font-family:"Courier New"'>match()</span> or <span
style='font-family:"Courier New"'>substitute()</span>, for instance), passing
it a string to match against and a <span style='font-family:"Courier New"'>match_results</span>
objects to receive the results of the match.<span style='mso-spacerun:yes'> 
</span>If the <span style='font-family:"Courier New"'>match()</span>/<span
style='font-family:"Courier New"'>substitute()</span> fails, the method returns
false.<span style='mso-spacerun:yes'>  </span>If it succeeds, it returns true,
and the <span style='font-family:"Courier New"'>match_results</span> object
stores the resulting array of <i>backreferences</i> internally.<span
style='mso-spacerun:yes'>  </span>(Here, the term <i>backreference</i> has the
same meaning as it does in Perl.<span style='mso-spacerun:yes'> 
</span>Backreferences provide extra information about what parts of the pattern
matched which parts of the string.)<span style='mso-spacerun:yes'> 
</span>There are methods on the <span style='font-family:"Courier New"'>match_results</span>
object to make the backreference information available.<span
style='mso-spacerun:yes'>  </span>For example:</p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>#include
&lt;iostream&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>#include
&lt;string&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>#include
“regexpr2.h”<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>using
namespace std;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>using
namespace regex;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>int
main() {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>match_results results;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>string str( “The book cost $12.34” );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>rpattern pat( “\\$(\\d+)(\\.(\\d\\d))?”
);<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:#339966'>// Match a
dollar sign followed by one or more digits,<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:#339966'>// optionally
followed by a period and two more digits.<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:#339966'>// The
double-escapes are necessary to satisfy the compiler.<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>match_results::backref_type br = pat.match(
str, results );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>if( br.matched ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span>cout &lt;&lt; “match success!” &lt;&lt;
endl;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span>cout &lt;&lt; “price: ” &lt;&lt; br
&lt;&lt; endl;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>} else {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span>cout &lt;&lt; “match failed!” &lt;&lt;
endl;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>return 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>}</span><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The above program would print out the following:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>match success!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>price: $12.34</span><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The following sections discuss the <span style='font-family:
"Courier New"'>rpattern</span> object in detail and how to customize your searches
to be faster and more efficient.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Note: all declarations in the header file (regexpr2.h) are
contained in the <span style='font-family:"Courier New"'>regex</span>
namespace.<span style='mso-spacerun:yes'>  </span>To use any of the objects,
methods or enumerations described in this document, you must prepend all
declarations with “<span style='font-family:"Courier New"'>regex::</span>” or
you must have the “<span style='font-family:"Courier New"'>using namespace
regex;</span>” directive somewhere within the enclosing scope of your
declarations.<span style='mso-spacerun:yes'>  </span>For simplicity, I’ve left
off the “<span style='font-family:"Courier New"'>regex::</span>” prefixes in
the rest of my code snippets.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc39890866">A Word about Speed</a></h1>

<p class=MsoNormal>Different regex engines are good on different types of
patterns.<span style='mso-spacerun:yes'>  </span>That said, I have found my
regex engine to be pretty quick.<span style='mso-spacerun:yes'>  </span>For a
benchmark, I matched the pattern “<span style='font-family:"Courier New"'>^([0-9]+)(\-|
|$)(.*)$</span>” against the string “<span style='font-family:"Courier New"'>100-
this is a line of ftp response which contains a message string</span>”.<span
style='mso-spacerun:yes'>  </span>GRETA is about 7 times faster than the regex
library in boost (<a href="http://www.boost.org/">http://www.boost.org</a>),
and about 10 times faster than the regular expression classes in ATL7.<span
style='mso-spacerun:yes'>  </span>For this input, GRETA is even faster than
Perl, although Perl is faster for some other patterns.<span
style='mso-spacerun:yes'>  </span>Most regex engines I have seen build up an
NFA <i style='mso-bidi-font-style:normal'>(<span style='mso-bidi-font-style:
italic'>non-deterministic finite state automaton)</span></i> and execute it
iteratively, often with a big, slow switch statement.<span
style='mso-spacerun:yes'>  </span>I have a different approach: patterns are
compiled into a directed, possibly cyclic graph, and matching happens by
traversing this graph recursively.<span style='mso-spacerun:yes'>  </span>In
addition, the code makes heavy use of templates to freeze the state of the
flags into the compiled pattern so that they don’t need to be checked at match
time.<span style='mso-spacerun:yes'>  </span>The result is a pretty lean blob
of code that can match your pattern quickly.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Even the best algorithms have their weaknesses, though.<span
style='mso-spacerun:yes'>  </span>Matching regular expressions with
backreferences is an NP-complete problem.<span style='mso-spacerun:yes'> 
</span>There are patterns that will make any backtracking regex engine take
exponential time to finish.<span style='mso-spacerun:yes'>  </span>(These
usually involve nested quantifiers.)<span style='mso-spacerun:yes'>  </span>If
you have a performance critical app, you would be smart to test your patterns for
speed, or profile your app to make sure you are not spending too much time
thrashing around in the regex code.<span style='mso-spacerun:yes'> 
</span>You’ve been warned!</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Also, see the section <a href="#_VC7_and_Managed_Code">VC7
and Managed Code</a> for some advice for compiling GRETA under VC7.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc39890867">Notice to Users of Version 1.x</a></h1>

<p class=MsoNormal>Many things have changed since version 1.x of the Regular
Expression Template Archive.<span style='mso-spacerun:yes'>  </span>If you have
code which uses version 1.x, you will not be able to use version 2 without
making changes to your code.<span style='mso-spacerun:yes'>  </span>Sorry!<span
style='mso-spacerun:yes'>  </span>There were a number of unsafe, unintuitive
interface features of version 1 that I felt were worth fixing for version
2.<span style='mso-spacerun:yes'>  </span>If you need version 1, I have a copy
and I’d be happy to give it to you.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Most notably, the <span style='font-family:"Courier New"'>regexpr</span>
object has gone away.<span style='mso-spacerun:yes'>  </span>It was a subclass
of <span style='font-family:"Courier New"'>std::string</span>, with <span
style='font-family:"Courier New"'>match()</span> and <span style='font-family:
"Courier New"'>substitute()</span> methods, and it stored the results of the
match/substitute internally.<span style='mso-spacerun:yes'>  </span>Subclassing
<span style='font-family:"Courier New"'>std::string</span> is dangerous because
<span style='font-family:"Courier New"'>std::string</span> doesn’t have a
virtual destructor.<span style='mso-spacerun:yes'>  </span>Also, matching is
conceptually a const operation, and it seemed wrong that it should change
internal state.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>match/count/substitute</span>
methods have moved to the <span style='font-family:"Courier New"'>rpattern</span>
object.<span style='mso-spacerun:yes'>  </span>The state that used to be stored
in the <span style='font-family:"Courier New"'>regexpr</span> object is now put
in a <span style='font-family:"Courier New"'>match_results/subst_results</span>
container, which is passed as an out parameter to the <span style='font-family:
"Courier New"'>match/substitute</span> methods.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Also, the <span style='font-family:"Courier New"'>CSTRINGS</span>
flag has gone away.<span style='mso-spacerun:yes'>  </span>It is no longer
necessary to optimize a pattern for use with C-style NULL-terminated
strings.<span style='mso-spacerun:yes'>  </span>When you pass a C-style string
to the <span style='font-family:"Courier New"'>rpattern::match</span> method,
the same optimization is used automatically.<span style='mso-spacerun:yes'> 
</span>(In early 2.X versions of the library, there was a <span
style='font-family:"Courier New"'>basic_rpattern_c</span> object for performing
this optimization, but it is no longer necessary and has been deprecated.)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Another minor change involves the <span style='font-family:
"Courier New"'>register_intrinsic_charset()</span> method.<span
style='mso-spacerun:yes'>  </span>It used to be a part of <span
style='font-family:"Courier New"'>rpattern</span>’s interface, but it has moved
to the syntax module.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Despite the sweeping interface changes, the majority of the
back-end code is unchanged.<span style='mso-spacerun:yes'>  </span>You should
expect patterns that worked in version 1.x to continue to work in version 2.</p>

<h1><a name="_Toc39890868">The rpattern Object</a></h1>

<p class=MsoCommentText><span style='font-size:12.0pt'>The </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> object contains the regular expression pattern
against which to match.<span style='mso-spacerun:yes'>  </span>It also exposes
the </span><span style='font-size:12.0pt;font-family:"Courier New"'>match()</span><span
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
"Courier New"'>substitute()</span><span style='font-size:12.0pt'>, and </span><span
style='font-size:12.0pt;font-family:"Courier New"'>count()</span><span
style='font-size:12.0pt'> methods you will use to perform regular expression
matches.<span style='mso-spacerun:yes'>  </span>When you instantiate an </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> object, the pattern is “compiled” into a structure
that speeds up pattern matching.<span style='mso-spacerun:yes'>  </span>Once
compiled, you may reuse the same pattern for multiple match operations.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>Here is how </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> is declared:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>template&lt; typename CI,<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>         
</span>typename SY = perl_syntax&lt;std::iterator_traits&lt;CI&gt;::value_type&gt;
&gt;<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>class basic_rpattern {<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>…<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>};<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>typedef
basic_rpattern&lt;std::basic_string&lt;TCHAR&gt;::const_iterator&gt; rpattern;</span><span
style='mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>typedef basic_rpattern&lt;TCHAR const *&gt;
rpattern_c;</span><span style='mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>The </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> class is a template on iterator type.<span
style='mso-spacerun:yes'>  </span>It is also a template on the syntax
module.<span style='mso-spacerun:yes'>  </span>By default, the Perl syntax
module is used, but you are free to write your own syntax and specify it as a
template parameter.<span style='mso-spacerun:yes'>  </span>See the section on
the <a href="#_The_Syntax_Module">Syntax Module</a>.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>The following sections
describe the methods available on the </span><span style='font-size:12.0pt;
font-family:"Courier New"'>rpattern</span><span style='font-size:12.0pt'>
object.<o:p></o:p></span></p>

<h2><a name="_Toc39890869"></a><a name="_rpattern::string_type"></a><span
style='mso-bookmark:_Toc39890869'>rpattern::string_type</span></h2>

<p class=MsoNormal><span style='font-family:"Courier New"'>rpattern::string_type</span>
is a typedef that is used in many of the following function prototypes.<span
style='mso-spacerun:yes'>  </span>It is defined as follows:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>typedef CI const_iterator;<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>typedef
std::iterator_traits&lt;const_iterator&gt;::value_type char_type;<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>typedef
std::basic_string&lt;char_type&gt; string_type;<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The typedef is a little complicated, but its effect is what
you would expect.<span style='mso-spacerun:yes'>  </span>If the result of
dereferencing a <span style='font-family:"Courier New"'>const_iterator</span>
is a <span style='font-family:"Courier New"'>char</span>, then <span
style='font-family:"Courier New"'>string_type</span> is the same as <span
style='font-family:"Courier New"'>std::string</span>.<span
style='mso-spacerun:yes'>  </span>If dereferencing a <span style='font-family:
"Courier New"'>const_iterator</span> results in a <span style='font-family:
"Courier New"'>wchar_t</span>, then <span style='font-family:"Courier New"'>string_type</span>
is the same as <span style='font-family:"Courier New"'>std::wstring</span>.</p>

<h2><a name="_Toc39890870">rpattern::rpattern</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>There are two
constructors for instantiating an </span><span style='font-size:12.0pt;
font-family:"Courier New"'>rpattern</span><span style='font-size:12.0pt'>
object.<span style='mso-spacerun:yes'>  </span>Here are their prototypes:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>rpattern::rpattern(
<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const
<a href="#_rpattern::string_type">string_type</a> &amp; pat, <o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>REGEX_FLAGS
flags=NOFLAGS,<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>REGEX_MODE
mode=MODE_DEFAULT ); <span style='color:#339966'>//
throw(bad_alloc,bad_regexpr);<o:p></o:p></span></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;page-break-after:avoid'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>rpattern::rpattern(
<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const
<a href="#_rpattern::string_type">string_type</a> &amp; pat, <o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const
<a href="#_rpattern::string_type">string_type</a> &amp; sub, <o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>REGEX_FLAGS
flags=NOFLAGS,<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in;page-break-after:
avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>REGEX_MODE
mode=MODE_DEFAULT ); <span style='color:#339966'>//
throw(bad_alloc,bad_regexpr);<o:p></o:p></span></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>Both methods require you
to specify a string containing the pattern to match.<span
style='mso-spacerun:yes'>  </span>Both methods allow you to specify some flags
that customize your search and the mode with which the pattern should be
matched (see <a href="#_Matching_Modes">Matching Modes</a>).<span
style='mso-spacerun:yes'>  </span>The first method does not require you to
specify a substitution string; the second one does.<span
style='mso-spacerun:yes'>  </span>If you do not specify a substitution string,
it is assumed to be the null string.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>Notice the (commented
out) exception specification, “</span><span style='font-size:12.0pt;font-family:
"Courier New"'>throw(bad_alloc, bad_regexpr)</span><span style='font-size:12.0pt'>,”
on the constructors.<span style='mso-spacerun:yes'>  </span>This means that the
constructor of an </span><span style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> object can throw an exception of type </span><span
style='font-size:12.0pt;font-family:"Courier New"'>bad_regexpr</span><span
style='font-size:12.0pt'> or </span><span style='font-size:12.0pt;font-family:
"Courier New"'>bad_alloc</span><span style='font-size:12.0pt'>.<span
style='mso-spacerun:yes'>  </span>This can happen when the specified pattern
contains illegal regular expression syntax, such as unbalanced
parentheses.<span style='mso-spacerun:yes'>  </span>It can also occur when the
substitution string refers to a backref that does not exist (for instance, if
the substitution string contains “</span><span style='font-size:12.0pt;
font-family:"Courier New"'>$6</span><span style='font-size:12.0pt'>”, and there
are not 6 groups in the pattern). The </span><span style='font-size:12.0pt;
font-family:"Courier New"'>bad_regexpr</span><span style='font-size:12.0pt'>
exception inherits from the </span><span style='font-size:12.0pt;font-family:
"Courier New"'>std::invalid_argument</span><span style='font-size:12.0pt'>
exception.<span style='mso-spacerun:yes'>  </span>The </span><span
style='font-size:12.0pt;font-family:"Courier New"'>bad_regexpr::what()</span><span
style='font-size:12.0pt'> method returns a pointer to a C-style string that
contains a description of the problem.<o:p></o:p></span></p>

<h2><a name="_Toc39890871">rpattern::match</a></h2>

<p class=MsoNormal>The match method is used to find patterns in strings.<span
style='mso-spacerun:yes'>  </span>There are a couple of different versions of
the match method.<span style='mso-spacerun:yes'>  </span>The first takes a <span
style='font-family:"Courier New"'>std::basic_string</span> as a parameter.<span
style='mso-spacerun:yes'>  </span>The second version takes two iterators, the
beginning and end of the string to match.<span style='mso-spacerun:yes'> 
</span>Finally, there is a version of the <span style='font-family:"Courier New"'>match()</span>
method that takes a pointer to a NULL-terminated string.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>template&lt; typename CH, typename TR, typename <st1:place
w:st="on"><st1:State w:st="on">AL</st1:State></st1:place> &gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>rpattern::backref_type rpattern::match( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const
std::basic_string&lt;CH,TR,AL&gt; &amp; str,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>match_results &amp;
results,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>    </span>size_type
pos = 0,<span style='mso-spacerun:yes'>            </span><span
style='color:#339966'>// offset to the start of the substring to match</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_type len = npos
) const; <span style='color:#339966'>//</span> <span style='color:#339966'>length
of the substring to match</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>rpattern::backref_type rpattern::match( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator
ibegin,<span style='mso-spacerun:yes'>        </span><span style='color:#339966'>//
start of the string to match<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator
iend,<span style='mso-spacerun:yes'>          </span><span style='color:#339966'>//
one past end of string to match<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>match_results &amp;
results ) const;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>rpattern::backref_type rpattern::match( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const char_type *
sz,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>match_results_c
&amp; results ) const;</span><span style='font-size:8.0pt;mso-bidi-font-size:
12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Notice that the <span style='font-family:"Courier New"'>match()</span>
method that takes a <span style='font-family:"Courier New"'>std::basic_string</span>
is a template on character, character traits and allocator.<span
style='mso-spacerun:yes'>  </span>This is necessary given that <span
style='font-family:"Courier New"'>basic_rpattern</span> is a template only on
iterator, but it gives us a little more flexibility then we really want.<span
style='mso-spacerun:yes'>  </span>If you accidentally pass in the wrong string
type (say, a <span style='font-family:"Courier New"'>std::wstring</span> when
the match method is really expecting a <span style='font-family:"Courier New"'>std::string</span>)
you will get a compile-time error informing you of your mistake.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>match()</span>
method returns an object of type <span style='font-family:"Courier New"'>rpattern::backref_type</span>.<span
style='mso-spacerun:yes'>   </span>If the match fails, an “empty backref” will
be returned.<span style='mso-spacerun:yes'>  </span>An empty backref contains
“false” in the <span style='font-family:"Courier New"'>matched</span>
member.<span style='mso-spacerun:yes'>  </span>If the match succeeds, the
backref contains information about where the pattern matched the string, and
contains “true” in the <span style='font-family:"Courier New"'>matched</span>
member.<span style='mso-spacerun:yes'>  </span>The following code demonstrates
the usage of the <span style='font-family:"Courier New"'>match()</span> method:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>const char * sz = “Here is a string to match.”;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>rpattern_c pat( “str.ng” ); <span style='color:#339966'>//
matches “string”, “strong”, etc.<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>match_results_c results;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>rpattern_c::backref_type br = pat.match( sz, results
);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>if( br.matched ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>    </span>printf(
“Backref: %.*s”, br.second – br.first, br.first );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>} else {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>    </span>printf(
“No match found.” );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}</span><span style='font-size:8.0pt;mso-bidi-font-size:
12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>In the above code, <span style='font-family:"Courier New"'>br.first</span>
is a pointer to the first character in the string that matched the pattern and <span
style='font-family:"Courier New"'>br.second</span> is a pointer to the last+1
character that matched the pattern.<span style='mso-spacerun:yes'> 
</span>Therefore, the length of the matched pattern is <span style='font-family:
"Courier New"'>br.second – br.first</span>.<span style='mso-spacerun:yes'> 
</span>(You’ll notice that this value is used as the precision of the string in
the <span style='font-family:"Courier New"'>printf()</span> format
statement.)<span style='mso-spacerun:yes'>  </span>The above code will generate
the following output: “<span style='font-family:"Courier New"'>Backref: string</span>”.<span
style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Notice the use of <span style='font-family:"Courier New"'>rpattern_c</span>
and <span style='font-family:"Courier New"'>match_results_c</span> in the above
example.<span style='mso-spacerun:yes'>  </span>These are typedefs for <span
style='font-family:"Courier New"'>basic_rpattern&lt;const TCHAR *&gt;</span>
and <span style='font-family:"Courier New"'>basic_match_results&lt;const TCHAR
*&gt;</span>, respectively.</p>

<h2><a name="_Toc39890872">rpattern::substitute</a></h2>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>substitute()</span>
method finds patterns and replaces the found substrings with insertion strings
you specify.<span style='mso-spacerun:yes'>  </span>It takes a <span
style='font-family:"Courier New"'>std::string</span> object as a parameter, and
a <span style='font-family:"Courier New"'>subst_results</span> container.<span
style='mso-spacerun:yes'>  </span>It also takes two optional integer
parameters, which you can use to specify the offset of the first character to
search and the length of the search string.<span style='mso-spacerun:yes'> 
</span>Here is the prototype:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>template&lt; typename CH, typename TR, typename <st1:place
w:st="on"><st1:State w:st="on">AL</st1:State></st1:place> &gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>size_t rpattern::substitute(
std::basic_string&lt;CH,TR,AL&gt; &amp; str, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span
style='mso-spacerun:yes'>                             </span>subst_results &amp;
results,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span
style='mso-spacerun:yes'>                             </span>size_type pos = 0,
<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span
style='mso-spacerun:yes'>                             </span>size_type len =
npos );</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoToc1>The return type is an unsigned integer representing the number
of substitutions made.<span style='mso-spacerun:yes'>  </span>If the pattern is
not found, no substitutions are made and the return value is 0.<span
style='mso-spacerun:yes'>  </span>The following example finds all instances of <span
style='font-family:"Courier New"'>\n</span> not preceded by <span
style='font-family:"Courier New"'>\r</span> and replaces them with <span
style='font-family:"Courier New"'>\r\n</span>:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>size_t insert_crlf( string &amp; str ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>static const
rpattern s_crlf( “(?&lt;!\r)\n”, “\r\n”, GLOBAL );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>subst_results
results;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>    </span>return
s_crlf.substitute( str, results );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
page-break-after:avoid'><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}</span><span style='font-size:8.0pt;mso-bidi-font-size:
12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoToc1>Later sections will describe the significance of “<span
style='font-family:"Courier New"'><a href="#_Optimizations">static const</a></span>”
and “<span style='font-family:"Courier New"'><a href="#_GLOBAL">GLOBAL</a></span>”
in the above example.<span style='mso-spacerun:yes'>  </span>Note the use of
the look-behind assertion, <span style='font-family:"Courier New"'>(?&lt;!\r)</span>,
in the example.<span style='mso-spacerun:yes'>  </span>It evaluates to true
when the preceding character is not a return character, but it doesn’t include
the preceding character in the match.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>When doing a global substitution, the next match operation
begins where the last substitution left off.<span style='mso-spacerun:yes'> 
</span>Thus, if the search string contains the word “<span style='font-family:
"Courier New"'>foo</span>”, pattern is “<span style='font-family:"Courier New"'>o</span>”,
and the substitution is “<span style='font-family:"Courier New"'>oo</span>”,
the resulting string will be, “<span style='font-family:"Courier New"'>foooo</span>”.</p>

<h2><a name="_Toc39890873">rpattern::count</a></h2>

<p class=MsoNormal>Use the <span style='font-family:"Courier New"'>count()</span>
method when you want to know the number of times a given pattern matches a
string, but you don’t care about where the matches occur or what they are
exactly.<span style='mso-spacerun:yes'>  </span>The <span style='font-family:
"Courier New"'>count()</span> method has three variants, which are analogous to
the three <span style='font-family:"Courier New"'>match()</span> methods.<span
style='mso-spacerun:yes'>  </span>Here’s one if its prototypes:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t rpattern::count( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator
ibegin,<span style='mso-spacerun:yes'>        </span><span style='color:#339966'>//
start of the string to match<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator iend
) const;<span style='mso-spacerun:yes'>  </span><span style='color:#339966'>//
one past end of string to match<o:p></o:p></span></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoToc1>Like the <span style='font-family:"Courier New"'>substitute()</span>
method, the next match begins where the previous one ended.<span
style='mso-spacerun:yes'>  </span>Thus, if you want to know how many times the
pattern “<span style='font-family:"Courier New"'>oo</span>” shows up in the
string “<span style='font-family:"Courier New"'>fooooo</span>”, the answer is
2, even though this pattern could conceivably match the string in 4 unique
places.<span style='mso-spacerun:yes'>  </span>Overlapping matches are not
counted.</p>

<h2><a name="_Toc39890874">rpattern::split</a></h2>

<p class=MsoNormal>Use the <span style='font-family:"Courier New"'>split()</span>
method when you have a string that you want to split into substrings, using a
regular expression as a delimiter.<span style='mso-spacerun:yes'> 
</span>Here’s one if its prototypes:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t rpattern::split( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator
ibegin,<span style='mso-spacerun:yes'>    </span><span style='color:#339966'>//
start of the string to match<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const_iterator
iend,<span style='mso-spacerun:yes'>      </span><span style='color:#339966'>//
one past end of string to match</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>split_results &amp;
results,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt;mso-pagination:
widow-orphan lines-together;page-break-after:avoid'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>int limit = 0 ) const;<span
style='color:#339966'><o:p></o:p></span></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoToc1>The <span style='font-family:"Courier New"'>split()</span> function
takes an optional “int limit” parameter which defaults to 0.<span
style='mso-spacerun:yes'>  </span>If it is greater than 0, it is the upper
limit on the number of fields to split the string into.<span
style='mso-spacerun:yes'>  </span>If it is 0, then there is no limit, except
that trailing empty fields are dropped.<span style='mso-spacerun:yes'> 
</span>If it is less that 0, then there is no limit, and empty trailing fields
are kept.<span style='mso-spacerun:yes'>  </span>As in perl, an empty leading
field is always dropped.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If your regular expression has capturing groups, these
back-references become fields in the split_results.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>split_results</span>
struct behaves like an STL container of std:strings.</p>

<h2><a name="_Toc39890875">rpattern::set_substitution</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>Sometimes you may want
to set the substitution string after the </span><span style='font-size:12.0pt;
font-family:"Courier New"'>rpattern</span><span style='font-size:12.0pt'>
object has been instantiated.<span style='mso-spacerun:yes'>  </span>For this,
you would use the </span><span style='font-size:12.0pt;font-family:"Courier New"'>set_substitution()</span><span
style='font-size:12.0pt'> method.<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>void
rpattern::set_substitution( const <a href="#_rpattern::string_type">string_type</a>
&amp; sub );<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in;text-indent:.5in'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
color:#339966'>// throw(bad_alloc,bad_regexpr);<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>The </span><span
style='font-size:12.0pt;font-family:"Courier New"'>set_substitution()</span><span
style='font-size:12.0pt'> method can be called as many times as you like.<span
style='mso-spacerun:yes'>  </span>Each time it is called, it replaces the old
substitution string with the new one.<span style='mso-spacerun:yes'> 
</span>Notice that the </span><span style='font-size:12.0pt;font-family:"Courier New"'>set_substitution()</span><span
style='font-size:12.0pt'> method can also throw a </span><span
style='font-size:12.0pt;font-family:"Courier New"'>bad_regexpr</span><span
style='font-size:12.0pt'> exception for ill-formed substitution strings.<o:p></o:p></span></p>

<h2><a name="_Toc39890876">rpattern::cgroups</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This method returns the
count of groups in the pattern string.<span style='mso-spacerun:yes'> 
</span>For a successfully parsed pattern, this number is always at least one,
because the entire pattern is considered group number 0.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t rpattern::cgroups()
const;<o:p></o:p></span></p>

<h1><a name="_Toc39890877"></a><a name="_The_CSTRINGS_Optimization"></a><a
name="_The_Rpattern_c_Object"></a><span style='mso-bookmark:_Toc39890877'>match_results,
subst_results and split_results</span></h1>

<p class=MsoNormal>The results of a <span style='font-family:"Courier New"'>match()</span>,
<span style='font-family:"Courier New"'>substitute()</span>, or <span
style='font-family:"Courier New"'>split()</span> operation are stored in the <span
style='font-family:"Courier New"'>match_results</span>, <span style='font-family:
"Courier New"'>subst_results</span>, and <span style='font-family:"Courier New"'>split_results</span>
containers, respectively.<span style='mso-spacerun:yes'>  </span>After a
successful <span style='font-family:"Courier New"'>match()</span>, <span
style='font-family:"Courier New"'>substitute()</span> or <span
style='font-family:"Courier New"'>split()</span>, they contain useful
information that can be queried for using the following methods.<span
style='mso-spacerun:yes'>  </span>All the <span style='font-family:"Courier New"'>match_results</span>
methods are also available on <span style='font-family:"Courier New"'>subst_results</span>.</p>

<h2><a name="_Toc39890878">match_results::cbackrefs</a></h2>

<p class=MsoNormal>This method returns the count of the internally saved
backrefs.<span style='mso-spacerun:yes'>  </span>It takes no parameters.<span
style='mso-spacerun:yes'>  </span>Here is the prototype:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t
match_results::cbackrefs() const;<o:p></o:p></span></p>

<p class=MsoToc1><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>After a successful <span style='font-family:"Courier New"'>match()</span>
operation, <span style='font-family:"Courier New"'>cbackrefs()</span> will
always return at least one.<span style='mso-spacerun:yes'>  </span>That is
because the part of the string that matched the entire pattern is always saved
in backref number 0 (like <span style='font-family:"Courier New"'>$&amp;</span>
in Perl).</p>

<h2><a name="_Toc39890879">match_results::backref</a></h2>

<p class=MsoNormal>This method returns the requested backref.<span
style='mso-spacerun:yes'>  </span>It takes one parameter, which is the integer
representing the backref to return.<span style='mso-spacerun:yes'>  </span>The
prototype for this method looks like:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const backref_type &amp;
match_results::backref( size_t cbackref ) const;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>As in Perl, backreferences are created as a side effect of
grouping.<span style='mso-spacerun:yes'>  </span>The substring that matched the
entire pattern is saved in backref number 0; the substring that matched the
pattern enclosed in the first set of parentheses is backref number 1, the
second set of parentheses is backref number 2, and so on.<span
style='mso-spacerun:yes'>  </span>Sets of parentheses are numbered by counting
opening parentheses from left to right.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If <span style='font-family:"Courier New"'>cbackref</span>
is greater than the number of saved backrefs, <span style='font-family:"Courier New"'>match_results::backref()</span>
throws a <span style='font-family:"Courier New"'>std::out_of_range</span>
exception.</p>

<h2><a name="_Toc39890880"></a><a name="_regexpr::backref_str"></a><span
style='mso-bookmark:_Toc39890880'>match_results::rstart</span></h2>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>rstart()</span>
method returns the offset to the first character in the specified backref.<span
style='mso-spacerun:yes'>  </span>Here is the prototype:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t
match_results::rstart( size_t cbackref = 0 ) const;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>After a global substitution operation, <span
style='font-family:"Courier New"'>rstart()</span> returns the offset to the
point in the string that would be the start of the backref if the string had
not been modified.<span style='mso-spacerun:yes'>  </span>That’s because it is
really an index into the backref string. See <span style='font-family:"Courier New"'><a
href="#_subst_results::backref_str">subst_results::backref_str</a></span>
below.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If <span style='font-family:"Courier New"'>cbackref</span>
is greater than the number of saved backrefs, <span style='font-family:"Courier New"'>match_results::rstart()</span>
throws a <span style='font-family:"Courier New"'>std::out_of_range</span>
exception.<span style='mso-spacerun:yes'>  </span></p>

<h2><a name="_Toc39890881">match_results::rlength</a></h2>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>rlength()</span>
method returns the length of the specified backref.<span
style='mso-spacerun:yes'>  </span>Here is the prototype:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>size_t
match_results::rlength( size_t cbackref = 0 ) const;<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>If <span style='font-family:"Courier New"'>cbackref</span>
is greater than the number of saved backrefs, <span style='font-family:"Courier New"'>match_results::rlength()</span>
throws a <span style='font-family:"Courier New"'>std::out_of_range</span>
exception.</p>

<h2><a name="_Toc39890882">match_results::all_backrefs</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This method returns a
const reference to the internal vector of backrefs.<span
style='mso-spacerun:yes'>  </span>The return value is const to prevent writing
to this vector.<span style='mso-spacerun:yes'>   </span>It is intended for
read-only.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const
match_results::backref_vector &amp; match_results::all_backrefs() const;<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc39890883"></a><a name="_subst_results::backref_str"></a><span
style='mso-bookmark:_Toc39890883'>subst_results::backref_str</span></h2>

<p class=MsoNormal>This method is only defined on the <span style='font-family:
"Courier New"'>subst_results</span> container.<span style='mso-spacerun:yes'> 
</span>It returns a const reference to the string to which the backreferences
point.<span style='mso-spacerun:yes'>  </span>Here is the prototype:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>const string_type &amp;
subst_results::backref_str() const;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>As I mentioned earlier, backrefs are really just a pair of
iterators into a string.<span style='mso-spacerun:yes'>  </span>But a
substitution modifies the string, and the backreferences need to refer to the
string as it was before it was modified.<span style='mso-spacerun:yes'> 
</span>For this to work, a copy of the string must be made before it is
changed.<span style='mso-spacerun:yes'>  </span>The backreferences are pointers
into the copy of the string.<span style='mso-spacerun:yes'>  </span>The <span
style='font-family:"Courier New"'>backref_str()</span> method returns a const
reference to the copy.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Note: this implies that doing substitutions on really big
strings is costly, because the regex engine must first make a copy of the
string before performing the substitution.<span style='mso-spacerun:yes'> 
</span>Often, you don’t need backreferences after a substitution, and a copy
does not need to be made.<span style='mso-spacerun:yes'>  </span>There is a
flag to turn off this expensive feature for these cases.<span
style='mso-spacerun:yes'>  </span>This is discussed in the section entitled <span
style='font-family:"Courier New"'><a href="#_NOBACKREFS">NOBACKREFS</a></span>.</p>

<h2><a name="_Toc39890884"></a><a name="_rpattern::register_intrinsic_charset"></a><span
style='mso-bookmark:_Toc39890884'>split_results::strings</span></h2>

<p class=MsoNormal>Use the <span style='font-family:"Courier New"'>split_results::strings()</span>
method to retrieve a read/write STL container of the strings representing the
results of a <span style='font-family:"Courier New"'>split()</span> operation.</p>

<h1><a name="_Toc39890885">The Syntax Module</a></h1>

<p class=MsoNormal>The regular expression syntax supported by default is the
syntax of Perl 5.6.<span style='mso-spacerun:yes'>  </span>The syntax is
defined in a separate module and is incorporated into the <span
style='font-family:"Courier New"'>rpattern</span> class by means of a template
parameter.<span style='mso-spacerun:yes'>  </span>You can define your own
syntax module if you like.<span style='mso-spacerun:yes'>  </span>Your module
must implement the following interface:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>template&lt; typename CH
&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>class my_syntax {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>public:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>typedef CH char_type;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>typedef
std::basic_string&lt;CH&gt;::iterator iterator;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>typedef
std::basic_string&lt;CH&gt;::const_iterator const_iterator;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>my_syntax(
REGEX_FLAGS flags );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>REGEX_FLAGS
get_flags() const;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>void
set_flags( REGEX_FLAGS flags );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>TOKEN reg_token( iterator &amp; icur, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>                  </span>const_iterator iend );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>TOKEN quant_token( iterator &amp; icur, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>                       </span>const_iterator iend );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>TOKEN charset_token( iterator &amp; icur, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>                         </span>const_iterator iend );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>TOKEN subst_token( iterator &amp; icur, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>                       </span>const_iterator iend );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>TOKEN ext_token( iterator &amp; icur, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>                     </span>const_iterator iend );<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>void
register_intrinsic_charset( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>char_type ch, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:19.5pt'><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>const std::basic_string&lt;CH&gt; &amp; str
); <span style='color:#339966'>// throw(bad_regexpr,std::bad_alloc);<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>};</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>TOKEN</span>
type is an enumeration, defined as follows:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>enum TOKEN { <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Can be returned by any syntax method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>NO_TOKEN = 0,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Token that can be returned by the
reg_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>BEGIN_GROUP,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>END_GROUP,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ALTERNATION,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>BEGIN_LINE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>END_LINE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>BEGIN_CHARSET,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>MATCH_ANY,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESCAPE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Tokens that can be returned by the
quant_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ONE_OR_MORE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ZERO_OR_MORE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ZERO_OR_ONE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ONE_OR_MORE_MIN,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ZERO_OR_MORE_MIN,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ZERO_OR_ONE_MIN,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  
</span>BEGIN_RANGE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>RANGE_SEPARATOR,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>END_RANGE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>END_RANGE_MIN,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// These may also be returned by the
reg_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_DIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_NOT_DIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_SPACE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_NOT_SPACE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_WORD,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_NOT_WORD,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_BEGIN_STRING,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_END_STRING,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_END_STRING_z,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_WORD_BOUNDARY,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_NOT_WORD_BOUNDARY,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_WORD_START,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_WORD_STOP,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_QUOTE_META_ON,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>ESC_QUOTE_META_OFF,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Tokens that can be returned by the
subst_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_BACKREF,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  
</span>SUBST_PREMATCH,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_POSTMATCH,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_MATCH,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_ESCAPE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_QUOTE_META_ON,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_UPPER_ON,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_UPPER_NEXT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_LOWER_ON,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_LOWER_NEXT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>SUBST_ALL_OFF,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Tokens that can be returned by the
charset_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NEGATE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_ESCAPE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_RANGE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_BACKSPACE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_END,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_ALNUM,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_ALNUM,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_ALPHA,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_ALPHA,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_BLANK,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_BLANK,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_CNTRL,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  
</span>CHARSET_</span> <span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>NOT_CNTRL,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_DIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_</span> <span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>NOT_DIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_GRAPH,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_GRAPH,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_LOWER,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_LOWER,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_PRINT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_PRINT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_PUNCT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_PUNCT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_SPACE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span>CHARSET_NOT_SPACE,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_UPPER,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_UPPER,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_XDIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>CHARSET_NOT_XDIGIT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>// Tokens that can be returned by the
ext_token method<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_NOBACKREF,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_POS_LOOKAHEAD,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_NEG_LOOKAHEAD,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_POS_LOOKBEHIND,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  
</span>EXT_NEG_LOOKBEHIND,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_INDEPENDENT,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>EXT_UNKNOWN<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>};<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If any syntax method returns a token other than <span
style='font-family:"Courier New"'>NO_TOKEN</span>, the character pointer (<span
style='font-family:"Courier New"'>icur</span>) must be advanced past the
token.<span style='mso-spacerun:yes'>  </span><span style='font-family:"Courier New"'>icur</span>
must not be advanced past the end of the string, <span style='font-family:"Courier New"'>iend</span>.<span
style='mso-spacerun:yes'>  </span>If <span style='font-family:"Courier New"'>NO_TOKEN</span>
is returned, <span style='font-family:"Courier New"'>icur</span> should not be
modified, except to move past any characters that should be ignored.</p>

<p class=MsoToc1><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Once you have defined your syntax module, you need to
instantiate an <span style='font-family:"Courier New"'>rpattern</span> template
that uses it.<span style='mso-spacerun:yes'>  </span>See the section on <a
href="#_Template_Instantiation">Template Instantiation</a> for help.</p>

<h2><a name="_Toc39890886">register_intrinsic_charset</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>The intrinsic character
sets are pretty handy.<span style='mso-spacerun:yes'>  </span>For instance, “</span><span
style='font-size:12.0pt;font-family:"Courier New"'>\s</span><span
style='font-size:12.0pt'>” matches the same thing as </span><span
style='font-size:12.0pt;font-family:"Courier New"'>“[\t\f\r\n ]</span><span
style='font-size:12.0pt'>”, and “</span><span style='font-size:12.0pt;
font-family:"Courier New"'>\w</span><span style='font-size:12.0pt'>” is
(roughly) a shorthand for “</span><span style='font-size:12.0pt;font-family:
"Courier New"'>[a-zA-Z_0-9]</span><span style='font-size:12.0pt'>”.<span
style='mso-spacerun:yes'>  </span>With the </span><span style='font-size:12.0pt;
font-family:"Courier New"'>register_intrinsic_charset()</span><span
style='font-size:12.0pt'> method, you can create your own.<span
style='mso-spacerun:yes'>  </span>Here’s the prototype:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>static void
my_syntax::register_intrinsic_charset( <o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>char_type ch, const
std::basic_string&lt;char_type&gt; &amp; str );<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:#339966'>//
throw(bad_regexpr,std::bad_alloc);</span></span><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;color:#339966'><o:p></o:p></span></p>

<p class=MsoCommentText><a name="_The_Syntax_Module"></a><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>You
would use it as follows:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New"'>my_syntax&lt;char&gt;::register_intrinsic_charset(
‘p’, “[aeiouAEIOU]” );<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>This
maps “</span><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>\p</span><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt'>” to “</span><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>[</span><span style='font-family:"Courier New"'>aeiouAEIOU</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>]</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>”.<span
style='mso-spacerun:yes'>  </span>In implementation, the character set is
“compiled” when you call </span><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'>register_intrinsic_charset()</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>, and when “</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>\p</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>” appears in any new
patterns, this compiled form gets linked into your pattern.<span
style='mso-spacerun:yes'>  </span>This speeds up pattern compilation, and
reduces memory usage, since the compiled character set is shared across all
your patterns.<span style='mso-spacerun:yes'>  </span>Note that with the above
call to </span><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>register_intrinsic_charset()</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>, no mapping of “</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>\P</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>” to “</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>[^</span><span
style='font-family:"Courier New"'>aeiouAEIOU</span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New"'>]</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>” is created.<span
style='mso-spacerun:yes'>  </span>If you want that mapping, you need to create
it yourself with another call to </span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New"'>register_intrinsic_charset()</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>The
case-sensitivity of a user-defined intrinsic character set is taken from the
context in which it is used.<span style='mso-spacerun:yes'>  </span>For
instance, if you define “</span><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'>\y</span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt'>” to be “</span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New"'>[a-z]</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>”, then in a case-sensitive
pattern, it matches only </span><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'>a-z</span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt'>, but in a case-insensitive pattern, it matches </span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>a-z</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'> and </span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>A-Z</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>If
you redefine an intrinsic character set, any compiled patterns that refer to
that character set are now invalid.<span style='mso-spacerun:yes'>  </span>You
must reinitialize them.<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc39890887"></a><a name="_Customizing_Your_Search"></a><span
style='mso-bookmark:_Toc39890887'>Customizing Your Search</span></h1>

<p class=MsoCommentText><span style='font-size:12.0pt'>It is possible to
customize your searches by specifying some flags in the rpattern
constructor.<span style='mso-spacerun:yes'>  </span>Here is an example:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>// Find all instances of
‘foo’, replace with ‘bar’, ignore case<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>rpattern pat( “foo”,
“bar”, NOCASE | GLOBAL );</span><span style='font-size:8.0pt;mso-bidi-font-size:
12.0pt'><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc39890888">NOCASE</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>Do a case-insensitive
search.<span style='mso-spacerun:yes'>  </span>Searches are by default
case-sensitive.<o:p></o:p></span></p>

<h2><a name="_Toc39890889"></a><a name="_GLOBAL"></a><span style='mso-bookmark:
_Toc39890889'>GLOBAL</span></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This flag causes the </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern::substitute()</span><span
style='font-size:12.0pt'> method to replace all substrings that match the
pattern.<span style='mso-spacerun:yes'>  </span>By default, only the first
substring that matches the pattern is replaced.<span style='mso-spacerun:yes'> 
</span>When used with the </span><span style='font-size:12.0pt;font-family:
"Courier New"'>rpattern::match()</span><span style='font-size:12.0pt'> method,
it causes all substrings that match the pattern to be found.<span
style='mso-spacerun:yes'>  </span>See the section on </span><span
style='font-size:12.0pt;font-family:"Courier New"'><a href="#_NOBACKREFS">NOBACKREFS</a></span><span
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
"Courier New"'><a href="#_FIRSTBACKREFS">FIRSTBACKREFS</a></span><span
style='font-size:12.0pt'> and </span><span style='font-size:12.0pt;font-family:
"Courier New"'><a href="#_ALLBACKREFS">ALLBACKREFS</a></span><span
style='font-size:12.0pt'> to find out how to control what information gets
saved in the backref vector.<span style='mso-spacerun:yes'>  </span>This flag
is ignored by the </span><span style='font-size:12.0pt;font-family:"Courier New"'>rpattern::count()</span><span
style='font-size:12.0pt'> method.<o:p></o:p></span></p>

<h2><a name="_Toc39890890">MULTILINE</a></h2>

<p class=MsoNormal>By default, ‘<span style='font-family:"Courier New"'>^</span>’
matches only the beginning of the string, and ‘<span style='font-family:"Courier New"'>$</span>’
matches only the end of the string (or at the newline preceding the end of the
string).<span style='mso-spacerun:yes'>  </span>When you use the <span
style='font-family:"Courier New"'>MULTILINE</span> flag, ‘<span
style='font-family:"Courier New"'>^</span>’ will also match the beginning of a
line (immediately after a newline character) and ‘<span style='font-family:
"Courier New"'>$</span>’ will also match before the end of the line
(immediately before a carriage return or newline character).<span
style='mso-spacerun:yes'>  </span>The assertions ‘<span style='font-family:
"Courier New"'>\A</span>’ and ‘<span style='font-family:"Courier New"'>\Z</span>’
are used to match only the beginning and end of the string respectively,
regardless of whether the <span style='font-family:"Courier New"'>MULTILINE</span>
flag has been specified.</p>

<h2><a name="_Toc39890891">SINGLELINE</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>By default, ‘</span><span
style='font-size:12.0pt;font-family:"Courier New"'>.</span><span
style='font-size:12.0pt'>’ matches any character besides the newline
character.<span style='mso-spacerun:yes'>  </span>When you specify </span><span
style='font-size:12.0pt;font-family:"Courier New"'>SINGLELINE</span><span
style='font-size:12.0pt'>, ‘</span><span style='font-size:12.0pt;font-family:
"Courier New"'>.</span><span style='font-size:12.0pt'>’ will match the newline
character, also.<span style='mso-spacerun:yes'>  </span>This can be used
together with the </span><span style='font-size:12.0pt;font-family:"Courier New"'>MULTILINE</span><span
style='font-size:12.0pt'> option.<span style='mso-spacerun:yes'>  </span>The
two only sound mutually exclusive.<o:p></o:p></span></p>

<h2><a name="_Toc39890892">EXTENDED</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This is the equivalent
of the </span><span style='font-size:12.0pt;font-family:"Courier New"'>/x</span><span
style='font-size:12.0pt'> pattern modifier in Perl.<span
style='mso-spacerun:yes'>  </span>When you specify </span><span
style='font-size:12.0pt;font-family:"Courier New"'>EXTENDED</span><span
style='font-size:12.0pt'>, any white space in you pattern that is not escaped
or in a character class is ignored.<span style='mso-spacerun:yes'>  </span>In
addition, any text following a </span><span style='font-size:12.0pt;font-family:
"Courier New"'>#</span><span style='font-size:12.0pt'> up to and including a
newline character is considered a comment and is ignored.<span
style='mso-spacerun:yes'>  </span>The idea is to make patterns more readable.<o:p></o:p></span></p>

<h2><a name="_Toc39890893">RIGHTMOST</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>Find the rightmost,
longest match.<span style='mso-spacerun:yes'>  </span>The default is to find
the leftmost, longest match.<o:p></o:p></span></p>

<h2><a name="_Toc39890894"></a><a name="_NOBACKREFS"></a><span
style='mso-bookmark:_Toc39890894'>NOBACKREFS</span></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This flag is used to
optimize substitution operations.<span style='mso-spacerun:yes'>  </span>By
default, backreferences are saved during substitution operations.<span
style='mso-spacerun:yes'>  </span>To make the backreferences available even
after the substitution operation has changed the string, it is necessary to
save a copy of the string before modifying it.<span style='mso-spacerun:yes'> 
</span>This can be an expensive operation, particularly if the string is very
long.<span style='mso-spacerun:yes'>  </span>Often, there is no need to know
the backreferences after a substitution operation completes, in which case the
copy operation was wasteful.<span style='mso-spacerun:yes'>  </span>The </span><span
style='font-size:12.0pt;font-family:"Courier New"'>NOBACKREFS</span><span
style='font-size:12.0pt'> flag is a hint to the regular expression engine that
you will not be using the backreferences after the substitution operation
completes.<span style='mso-spacerun:yes'>  </span>This eliminates the need to
make a copy of the string.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>If your substitution
string contains backreferences, such as ‘</span><span style='font-size:12.0pt;
font-family:"Courier New"'>$2</span><span style='font-size:12.0pt'>’, then a
copy of the string needs to be made anyway, and the </span><span
style='font-size:12.0pt;font-family:"Courier New"'>NOBACKREFS</span><span
style='font-size:12.0pt'> flag is ignored.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>This flags is ignored by
the </span><span style='font-size:12.0pt;font-family:"Courier New"'>match()</span><span
style='font-size:12.0pt'> and </span><span style='font-size:12.0pt;font-family:
"Courier New"'>count()</span><span style='font-size:12.0pt'> methods.<o:p></o:p></span></p>

<h2><a name="_Toc39890895"></a><a name="_ALLBACKREFS"></a><span
style='mso-bookmark:_Toc39890895'>ALLBACKREFS</span></h2>

<p class=MsoNormal>By default, when doing a global match or substitute
operation, the backref vector only contains the backrefs from the last
successful match.<span style='mso-spacerun:yes'>  </span>Sometimes, it is
helpful to know the backref information for all the matches.<span
style='mso-spacerun:yes'>  </span>If you specify <span style='font-family:"Courier New"'>ALLBACKREFS</span>,
then the backref information for each successive match will be appended to the
backref vector, instead of replacing it.</p>

<h2><a name="_Toc39890896"></a><a name="_FIRSTBACKREFS"></a><span
style='mso-bookmark:_Toc39890896'>FIRSTBACKREFS</span></h2>

<p class=MsoNormal>This flag is like <span style='font-family:"Courier New"'><a
href="#_ALLBACKREFS">ALLBACKREFS</a></span>, except that only information from
the complete match (backref 0) is saved for each successive match.</p>

<h2><a name="_Toc39890897">NORMALIZE</a></h2>

<p class=MsoNormal>If the <span style='font-family:"Courier New"'>NORMALIZE</span>
flag is specified, the regular expression parser performs the following
normalizations:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\n</span>” is turned into the newline character, ‘<span
style='font-family:"Courier New"'>\n</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\r</span>” is turned into the return character, ‘<span
style='font-family:"Courier New"'>\r</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\t</span>” is turned into the tab character, ‘<span
style='font-family:"Courier New"'>\t</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\f</span>” is turned into the form-feed character, ‘<span
style='font-family:"Courier New"'>\f</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\v</span>” is turned into the vertical-feed character, ‘<span
style='font-family:"Courier New"'>\v</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\a</span>” is turned into the bell character, ‘<span
style='font-family:"Courier New"'>\a</span>’.</p>

<p class=MsoNormal style='margin-left:.5in'>The string “<span style='font-family:
"Courier New"'>\\\\</span>” is turned into the backslash character, ‘<span
style='font-family:"Courier New"'>\\</span>’.</p>

<p class=MsoToc1><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This can be especially useful if you are accepting the
pattern and substitution strings from a user as input.</p>

<h1><a name="_Toc39890898"></a><a name="_Matching_Modes"></a><span
style='mso-bookmark:_Toc39890898'>Matching Modes</span></h1>

<p class=MsoNormal>By default, the pattern matching algorithm is a depth-first,
recursive search.<span style='mso-spacerun:yes'>  </span>It is fast and
effective, but it has a limitation: the size of your process’s stack.<span
style='mso-spacerun:yes'>  </span>If you run out of stack space during a match
operation, one of two things will happen.<span style='mso-spacerun:yes'> 
</span>If you are on a Microsoft platform, the exception is handled and
execution continues as if the pattern failed to match (which may or may not be
the right answer).<span style='mso-spacerun:yes'>  </span>If you are not on a
Microsoft platform, the exception cannot be handled, and your process will dump
core and die.<span style='mso-spacerun:yes'>  </span>It’s not very nice to have
a process die when given legal input, so GRETA gives you the option to perform
matches in a completely safe manner, using an iterative algorithm that is
stack-conservative.<span style='mso-spacerun:yes'>  </span>The different
matching-modes are described below.<span style='mso-spacerun:yes'>  </span>You
can specify these modes to the <span style='font-family:"Courier New"'>rpattern</span>
constructor.</p>

<h2><a name="_Toc39890899">MODE_FAST</a></h2>

<p class=MsoNormal>On Microsoft platforms, this is the default mode.<span
style='mso-spacerun:yes'>  </span>It uses the recursive algorithm.<span
style='mso-spacerun:yes'>  </span>As the name suggests, it is fast, but it can
tear through stack space pretty quick for certain types of patterns.<span
style='mso-spacerun:yes'>  </span>The worst offender is a group
quantifier.<span style='mso-spacerun:yes'>  </span>This pattern eats lots of
stack: “<span style='font-family:"Courier New"'>(.)+</span>” whereas this one
does not: “<span style='font-family:"Courier New"'>.+</span>”.<span
style='mso-spacerun:yes'>  </span>You should use fast mode when your patterns
do not quantify groups or use the <span style='font-family:"Courier New"'>(?R)</span>
extension (see <a href="#_Recursive_Patterns">Recursive Patterns</a>), or when
you are not accepting the string and the pattern from users.</p>

<h2><a name="_Toc39890900"></a><a name="_MODE_SAFE"></a><span style='mso-bookmark:
_Toc39890900'>MODE_SAFE</span></h2>

<p class=MsoNormal>This mode uses the slower, safer iterative algorithm.<span
style='mso-spacerun:yes'>  </span>It will not overflow the stack.<span
style='mso-spacerun:yes'>  </span>Use this mode when you cannot make
assumptions about the pattern and the string (eg., you are accepting them as
input from users).<span style='mso-spacerun:yes'>  </span>Also, you can use
this mode when your stack space is small, or if you are in a DLL and you cannot
make assumptions about the size of your process’s stack space.<span
style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>You should be aware that safe mode will occasionally need to
make heap allocations, which could fail in low-memory situations and generate
an exception.<span style='mso-spacerun:yes'>  </span>You should wrap calls to <span
style='font-family:"Courier New"'>match()</span>, <span style='font-family:
"Courier New"'>count()</span> and <span style='font-family:"Courier New"'>substitute()</span>
in a <span style='font-family:"Courier New"'>try/catch</span> block and handle
any <span style='font-family:"Courier New"'>std::bad_alloc</span> exceptions
that may get thrown.</p>

<h2><a name="_Toc39890901">MODE_MIXED</a></h2>

<p class=MsoNormal>This is the default mode on non-Microsoft platforms.<span
style='mso-spacerun:yes'>  </span>When operating in mixed mode, GRETA uses a
simple heuristic to determine on a per-pattern basis which algorithm is the
best to use.<span style='mso-spacerun:yes'>  </span>Patterns that contain
quantified groups, like “<span style='font-family:"Courier New"'>(.)+</span>”,
are matched using safe mode, as are patterns that use the <span
style='font-family:"Courier New"'>(?R)</span> extension.<span
style='mso-spacerun:yes'>  </span>All other patterns are matched using the fast
mode.</p>

<h1><a name="_Toc39890902">Known Issues and Perl Incompatibilities</a></h1>

<p class=MsoNormal>There are a few things my code does a bit differently than
Perl.<span style='mso-spacerun:yes'>  </span>These are things that could trip
you up, and you should be aware of them.</p>

<h2><a name="_Toc39890903">Embedded Code in a Regular Expression</a></h2>

<p class=MsoNormal>Perl lets you put Perl code directly into a regex with the <span
style='font-family:"Courier New"'>(?{ <i style='mso-bidi-font-style:normal'>code</i>
})</span> extension.<span style='mso-spacerun:yes'>  </span>You can’t embed
Perl code in a GRETA regular expression.<span style='mso-spacerun:yes'> 
</span>Duh!<span style='mso-spacerun:yes'>  </span>But see <a
href="#_Recursive_Patterns">Recursive Patterns</a> for a useful hack that might
get you what you’re looking for.</p>

<h2><a name="_Toc39890904">Pattern Modifier Scope</a></h2>

<p class=MsoNormal>In the pattern “<span style='font-family:"Courier New"'>a(?i)b</span>”,
<span style='font-family:"Courier New"'>(?i)</span> turns on case-insensitive
pattern matching.<span style='mso-spacerun:yes'>  </span>In both Perl and
GRETA, pattern modifiers such as <span style='font-family:"Courier New"'>(?i)</span>
have the scope of the nearest enclosing group.<span style='mso-spacerun:yes'> 
</span>Outside of that group, they have no effect.<span
style='mso-spacerun:yes'>  </span>However, in GRETA, the scope of the pattern
modifier extends only to the right, whereas in Perl it extends both to the
right and left.<span style='mso-spacerun:yes'>  </span>For example, in Perl,
the above example would match the string “<span style='font-family:"Courier New"'>AB</span>”,
but in GRETA it would not because the “<span style='font-family:"Courier New"'>a</span>”
appears to the left of the <span style='font-family:"Courier New"'>(?i)</span>
modifier.</p>

<h2><a name="_Toc39890905">Comment Blocks Before Quantifiers</a></h2>

<p class=MsoNormal>Perl lets you write patterns like <span style='font-family:
"Courier New"'>/X(?#Match X 3 times){3}/</span>, where the bit in <span
style='font-family:"Courier New"'>(?#...)</span> is a comment, and <span
style='font-family:"Courier New"'>{3}</span> is a quantifier that applies to <span
style='font-family:"Courier New"'>X</span>.<span style='mso-spacerun:yes'> 
</span>(I don’t know who would write such a pattern, but Perl programmers are a
pretty sick bunch.)<span style='mso-spacerun:yes'>  </span>In GRETA, comment
groups logically separate quantifiers from the things quantified, so this will
not match <span style='font-family:"Courier New"'>XXX</span> like it does in
Perl.</p>

<h2><a name="_Toc39890906"></a><a name="_POSIX-style_Intrinsic_Character"></a><span
style='mso-bookmark:_Toc39890906'>Variable Width Look-Behind Assertions</span></h2>

<p class=MsoNormal>Perl doesn’t allow variable-width look-behind assertions,
probably because it can be really expensive.<span style='mso-spacerun:yes'> 
</span>GRETA allows it, and lets you shoot yourself if you’re not careful.<span
style='mso-spacerun:yes'>  </span>For variable-width look-behind assertions,
every evaluation of the look-behind is like a rightmost pattern match unto
itself, complete with backtracking.<span style='mso-spacerun:yes'>  </span>This
can result in very severe exponential behavior, especially if you’re using your
pattern to match very long strings.<span style='mso-spacerun:yes'>  </span>I
have done my best to protect you, though.<span style='mso-spacerun:yes'> 
</span>GRETA does static width analysis of your look-behind assertions.<span
style='mso-spacerun:yes'>  </span>This analysis is fairly robust; for example,
it recognizes that the pattern “<span style='font-family:"Courier New"'>(\d{3}-){2}\d{4}</span>”
must match exactly 12 characters (a hyphen-separated telephone number, for
instance).<span style='mso-spacerun:yes'>  </span>If the static analysis
reveals that the look-behind assertion must match between <span
style='font-family:"Courier New"'>N</span> and <span style='font-family:"Courier New"'>M</span>
characters, it only tries matching in those places where a match is
possible.<span style='mso-spacerun:yes'>  </span>In the previous example, the
pattern matcher would back up exactly 12 characters and look for a phone
number.<span style='mso-spacerun:yes'>  </span>If it fails, it gives up without
looking anyplace else.</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal>By the way, you are allowed to create back-references in
your positive look-behind assertions and use them later in your pattern and
access then after a successful match.</p>

<h2><a name="_Toc39890907"></a><a name="_Recursive_Patterns"></a><span
style='mso-bookmark:_Toc39890907'>Recursive Patterns</span></h2>

<p class=MsoNormal>Perl lets you embed code directly into your patters with the
<span style='font-family:"Courier New"'>(?{ <i style='mso-bidi-font-style:normal'>code</i>
})</span> extension, which relies on the Perl interpreter to interpolate the
code and execute it at pattern match time.<span style='mso-spacerun:yes'> 
</span>One very nice application of this is to write recursive patterns for
matching things like balanced, nested parenthesis, XML tags, etc.<span
style='mso-spacerun:yes'>  </span>Obviously, I can’t call out to an interpreter
in C++.<span style='mso-spacerun:yes'>  </span>But I have included experimental
support for recursive patterns with the <span style='font-family:"Courier New"'>(?R)</span>
extension.<span style='mso-spacerun:yes'>  </span>For example, consider the
following pattern (assume EXTENDED is used so white space is ignored):</p>

<p class=MsoNormal style='margin-left:.5in'><span style='font-family:"Courier New"'>\(
( (?&gt;[^()]+) | (?R) )* \)<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>First, you match an opening paren.<span
style='mso-spacerun:yes'>  </span>Then you match a bunch of stuff that is not
an opening or closing paren.<span style='mso-spacerun:yes'>  </span>Then, if
you can match a closing paren you are done.<span style='mso-spacerun:yes'> 
</span>Otherwise, you recurse by matching an opening paren again, followed by a
bunch of stuff that is not a paren, etc, etc.<span style='mso-spacerun:yes'> 
</span>You finish when you find a matching paren for the first one you found.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This extension was inspired by PCRE (Perl-compatible regular
expressions) at <a href="http://www.pcre.org/">http://www.pcre.org</a>.<span
style='mso-spacerun:yes'>  </span></p>

<h1><a name="_Toc39890908">Compile-Time Switches</a></h1>

<p class=MsoNormal>Here are some #define’s to give you control of some aspects
of GRETA’s behavior.</p>

<h2><a name="_Toc39890909"></a><a name="_REGEX_WIDE_AND_NARROW"></a><span
style='mso-bookmark:_Toc39890909'><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_WIDE_AND_NARROW</span></span><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:
JA;mso-bidi-language:AR-SA'>Define </span><span style='font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-fareast-language:
JA;mso-bidi-language:AR-SA'>REGEX_WIDE_AND_NARROW</span><span style='mso-fareast-font-family:
"MS Mincho";mso-fareast-language:JA;mso-bidi-language:AR-SA'> if you plan to
match wide and narrow strings in the same executable.<span
style='mso-spacerun:yes'>  </span>This forces the instantiation of both the
wide and narrow versions of the pattern matching routines.<span
style='mso-spacerun:yes'>  </span>Note that this will make your executable
bigger.<o:p></o:p></span></p>

<h2><a name="_Toc39890910"></a><a name="_REGEX_POSIX"></a><span
style='mso-bookmark:_Toc39890910'><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_POSIX</span></span><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:
JA;mso-bidi-language:AR-SA'>Define </span><span style='font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'>REGEX_POSIX</span><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'> if you want to use the POSIX
syntax module.<span style='mso-spacerun:yes'>  </span>It causes the appropriate
templates to get instantiated.<o:p></o:p></span></p>

<h2><a name="_Toc39890911"></a><a name="_REGEX_NO_PERL"></a><span
style='mso-bookmark:_Toc39890911'><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_NO_PERL</span></span><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:
JA;mso-bidi-language:AR-SA'>Define </span><span style='font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'>REGEX_NO_PERL</span><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'> if you are not planning on using
the Perl syntax module.<span style='mso-spacerun:yes'>  </span>It prevents the
Perl templates from getting instantiated.<span style='mso-spacerun:yes'> 
</span>This saves some space.<o:p></o:p></span></p>

<h2><a name="_Toc39890912"><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_DEBUG</span></a><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:
JA;mso-bidi-language:AR-SA'>In debug mode, the GRETA performs sanity checks at
run-time.<span style='mso-spacerun:yes'>  </span>Among other things, it turns
off the arena allocator and turns on run-time type checking in the type-unsafe
parts of the code.<span style='mso-spacerun:yes'>  </span>This makes the code
run very slow, but it’s a good idea to try your patterns a few times with
REGEX_DEBUG on (-DREGEX_DEBUG=1), just to make sure everything is kosher.<span
style='mso-spacerun:yes'>  </span>If you define any of: DEBUG, _DEBUG or DBG,
then REGEX_DEBUG gets turned on automatically.<span style='mso-spacerun:yes'> 
</span>To override this, explicitly turn it off with –DREGEX_DEBUG=0.<o:p></o:p></span></p>

<h2><a name="_Toc39890913"><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_DEBUG_HEAP</span></a><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal>When parsing a pattern, GRETA does a number of
allocations.<span style='mso-spacerun:yes'>  </span>To speed up the parsing
phase, the allocations come from an arena.<span style='mso-spacerun:yes'> 
</span>This is a significant performance enhancement, but it can interfere with
debug tools like AppVerifier and PageHeap which track allocations.<span
style='mso-spacerun:yes'>  </span>By turning REGEX_DEBUG_HEAP on
(-DREGEX_DEBUG_HEAP=1), you can effectively turn off arena allocation.<span
style='mso-spacerun:yes'>  </span>By default, REGEX_DEBUG_HEAP is turned on
when REGEX_DEBUG is on.</p>

<h2><a name="_Toc39890914"><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_STACK_ALIGNMENT</span></a><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal>Anyone who has written a low-level memory routine and tried
to make it portable has run into alignment problems.<span
style='mso-spacerun:yes'>  </span>I hit one such problem when writing GRETA’s
stack class.<span style='mso-spacerun:yes'>  </span>It constructs objects of
unknown type in place from a block of pre-allocated memory, and it tries to be
clever about alignment.<span style='mso-spacerun:yes'>  </span>But it’s not
perfect.<span style='mso-spacerun:yes'>  </span>(Blame the C++ standardization
committee or Bjarne Stroustrup, but don’t blame me.)<span
style='mso-spacerun:yes'>  </span>If you’re getting a compiler error in <span
style='font-family:"Courier New"'>restack.h</span> on a line that looks like
this:</p>

<p class=MsoNormal style='margin-left:.5in;mso-layout-grid-align:none;
text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-layout-grid-align:none;
text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'>static_assert&lt; (ALIGNMENT &gt;= alignof&lt;T&gt;::value) &gt; <span
style='color:blue'>const</span> align_test;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>then you have hit an alignment problem.<span
style='mso-spacerun:yes'>  </span>Relax, it is easy to fix.<span
style='mso-spacerun:yes'>  </span>Just compile with:
–DREGEX_STACK_ALIGNMENT=8.<span style='mso-spacerun:yes'>  </span>If that
doesn’t work, try an alignment of 16 or 32.</p>

<h2><a name="_Toc39890915"></a><a name="_REGEX_FOLD_INSTANTIATIONS"></a><span
style='mso-bookmark:_Toc39890915'><span style='mso-fareast-font-family:"MS Mincho";
mso-fareast-language:JA;mso-bidi-language:AR-SA'>REGEX_FOLD_INSTANTIATIONS</span></span><span
style='mso-fareast-font-family:"MS Mincho";mso-fareast-language:JA;mso-bidi-language:
AR-SA'><o:p></o:p></span></h2>

<p class=MsoNormal>On many implementations of the STL, <span style='font-family:
"Courier New"'>string::iterator</span> is not a <span style='font-family:"Courier New"'>typedef</span>
for <span style='font-family:"Courier New"'>char*</span>. Rather, it is a
wrapper class. As a result, the regex code gets instantiated twice, once for
bare pointers (<span style='font-family:"Courier New"'>rpattern_c</span>) and
once for the wrapped pointers (<span style='font-family:"Courier New"'>rpattern</span>).
But if there is a conversion from the bare pointer to the wrapped pointer, then
we only need to instantiate the template for the wrapped pointers, and the code
will work for the bare pointers, too. This can be a significant space
savings.<span style='mso-spacerun:yes'>  </span>The <span style='font-family:
"Courier New"'>REGEX_FOLD_INSTANTIONS</span> macro controls this optimization.
The default is &quot;off&quot; for backwards compatibility. To turn the
optimization on, compile with: -DREGEX_FOLD_INSTANTIATIONS=1.<span
style='mso-spacerun:yes'>  </span>When instantiation-folding is enabled, <span
style='font-family:"Courier New"'>rpattern_c</span> and <span style='font-family:
"Courier New"'>match_results_c</span> are typedefs for <span style='font-family:
"Courier New"'>rpattern</span> and <span style='font-family:"Courier New"'>match_results</span>,
and attempts to use <span style='font-family:"Courier New"'>basic_rpattern&lt;const
TCHAR *&gt;</span> directly will result in linker errors.</p>

<h2><a name="_Toc39890916"></a><a name="_REGEX_TO_INSTANTIATE"></a><span
style='mso-bookmark:_Toc39890916'>REGEX_TO_INSTANTIATE</span></h2>

<p class=MsoNormal>To allow separate compilation of the <span style='font-family:
"Courier New"'>basic_rpattern</span> template, I instantiate it on the iterator
types that I think would be most useful. By default, I instantiate <span
style='font-family:"Courier New"'>basic_rpattern</span> on <span
style='font-family:"Courier New"'>std::basic_string&lt;TCHAR&gt;::const_iterator</span>
and <span style='font-family:"Courier New"'>const TCHAR*</span>.<span
style='mso-spacerun:yes'>  </span>Your requirements may be different,
however.<span style='mso-spacerun:yes'>  </span>If you would like to create
additional instantiations, or if you don’t need one of the standard
instantiations, you should use the <span style='font-family:"Courier New"'>REGEX_TO_INSTANTIATE</span>
macro.<span style='mso-spacerun:yes'>  </span>Just set it equal to a
comma-separated list of iterator types for which you would like to create
instantiations.<span style='mso-spacerun:yes'>  </span>For instance, if you
need to match <span style='font-family:"Courier New"'>std::wstring</span> and <span
style='font-family:"Courier New"'>char*</span>, then you could <span
style='font-family:"Courier New"'>–DREGEX_TO_INSTANTIATE=std::wstring::const_iterator,char*</span>.<span
style='mso-spacerun:yes'>  </span>With this macro definition, you will be able
to use <span style='font-family:"Courier New"'>basic_rpattern&lt;std::wstring::
const_iterator&gt;</span> and <span style='font-family:"Courier New"'>basic_rpattern&lt;char*&gt;</span>
in your code.<span style='mso-spacerun:yes'>  </span>As a side-note, if you use
a non-const iterator type with <span style='font-family:"Courier New"'>basic_rpattern</span>
(like <span style='font-family:"Courier New"'>char*</span>), then the resulting
backreferences will also be non-const.<span style='mso-spacerun:yes'> 
</span>This gives you the nice benefit of being able to modify the underlying
string by writing through your backreferences.</p>

<h1><a name="_Toc39890917">Miscellaneous</a></h1>

<p class=MsoCommentText><span style='font-size:12.0pt'>Here are a couple of
random things to be aware of.<o:p></o:p></span></p>

<h2><a name="_Toc39890918"></a><a name="_Optimizations"></a><span
style='mso-bookmark:_Toc39890918'>Static Const Patterns</span></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>Make your patterns “</span><span
style='font-size:12.0pt;font-family:"Courier New"'>static const</span><span
style='font-size:12.0pt'>” if you can.<span style='mso-spacerun:yes'> 
</span>That way, they are compiled once when the thread of execution passes
over their declarations, not every time.<span style='mso-spacerun:yes'> 
</span>Consider the two following functions:<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>void good_function( string
&amp; str ) {<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>static const rpattern static_pattern( “your
pattern here” );<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>static_pattern.substitute( str );<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>void bad_function( string
&amp; str ) {<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>rpattern auto_pattern( “your pattern here”
);<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span>auto_pattern.substitute( str );<o:p></o:p></span></p>

<p class=MsoCommentText style='margin-left:.5in'><span style='font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New"'>}</span><span
style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>In </span><span
style='font-size:12.0pt;font-family:"Courier New"'>good_function()</span><span
style='font-size:12.0pt'>, the </span><span style='font-size:12.0pt;font-family:
"Courier New"'>static_pattern</span><span style='font-size:12.0pt'> object is
initialized once the first time </span><span style='font-size:12.0pt;
font-family:"Courier New"'>good_function()</span><span style='font-size:12.0pt'>
is called.<span style='mso-spacerun:yes'>  </span>Thereafter, </span><span
style='font-size:12.0pt;font-family:"Courier New"'>good_function()</span><span
style='font-size:12.0pt'> can be called as many times as you like, and you
won’t incur the penalty of recompiling the pattern.<span
style='mso-spacerun:yes'>  </span>The </span><span style='font-size:12.0pt;
font-family:"Courier New"'>static_pattern</span><span style='font-size:12.0pt'>
object is cleaned up only when the program terminates.<span
style='mso-spacerun:yes'>  </span>In </span><span style='font-size:12.0pt;
font-family:"Courier New"'>bad_function()</span><span style='font-size:12.0pt'>,
the </span><span style='font-size:12.0pt;font-family:"Courier New"'>auto_pattern</span><span
style='font-size:12.0pt'> object is initialized every time </span><span
style='font-size:12.0pt;font-family:"Courier New"'>bad_function()</span><span
style='font-size:12.0pt'> is called, and it is cleaned up every time </span><span
style='font-size:12.0pt;font-family:"Courier New"'>bad_function()</span><span
style='font-size:12.0pt'> returns.<span style='mso-spacerun:yes'>  </span>This
is unnecessary overhead since the pattern you are looking for is not changing
each time.<span style='mso-spacerun:yes'>  </span>But read the <a
href="#_Thread-safety">Thread-safety</a> section below for one small caveat.<o:p></o:p></span></p>

<h2><a name="_Toc39890919"></a><a name="_Thread-safety"></a><span
style='mso-bookmark:_Toc39890919'>Thread-safety</span></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>A const </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> object is completely thread-safe.<span
style='mso-spacerun:yes'>  </span>For instance, if you declare an </span><span
style='font-size:12.0pt;font-family:"Courier New"'>rpattern</span><span
style='font-size:12.0pt'> object to be “</span><span style='font-size:12.0pt;
font-family:"Courier New"'>static const</span><span style='font-size:12.0pt'>”,
you can use it in multiple threads to perform simultaneous </span><span
style='font-size:12.0pt;font-family:"Courier New"'>match() </span><span
style='font-size:12.0pt'>or </span><span style='font-size:12.0pt;font-family:
"Courier New"'>substitute()</span><span style='font-size:12.0pt'>
operations.<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>However, VC does no
synchronization while <i>constructing</i> function-local, static objects.<span
style='mso-spacerun:yes'>  </span>(Sad, but true.)<span
style='mso-spacerun:yes'>  </span>It’s possible for two threads to try to
initialize a static const pattern simultaneously.<span
style='mso-spacerun:yes'>  </span>But fear not! I’ve provided a
work-around.<span style='mso-spacerun:yes'>  </span>You can use the </span><span
style='font-size:12.0pt;font-family:"Courier New"'>STATIC_RPATTERN</span><span
style='font-size:12.0pt'> macro to declare all your static const patterns. <span
style='mso-spacerun:yes'> </span>If </span><span style='font-size:12.0pt;
font-family:"Courier New"'>_MT</span><span style='font-size:12.0pt'> is
defined, then </span><span style='font-size:12.0pt;font-family:"Courier New"'>STATIC_RPATTERN</span><span
style='font-size:12.0pt'> will guard all your rpattern constructions with a
critical section.<o:p></o:p></span></p>

<h2><a name="_Toc39890920">Stack Usage</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>By default, GRETA uses
recursion in a depth-first search for matches.<span style='mso-spacerun:yes'> 
</span>If you are matching against a very long string (several thousands of
characters long), then there is a chance you could overflow the stack.<span
style='mso-spacerun:yes'>  </span>If you use the VC compiler on a Win32
platform, then GRETA traps the stack overflow exception and resets the stack
guard page so that any additional stack overflows that may occur can also be
handled.<span style='mso-spacerun:yes'>  </span>In that case, execution will
continue as if the pattern had failed to match.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>An ounce of prevention
goes a long way, however.<span style='mso-spacerun:yes'>  </span>There are some
simple things you can do to prevent stack overflows.<span
style='mso-spacerun:yes'>  </span>The first is to not match against strings
that are 1000’s of characters long.<span style='mso-spacerun:yes'>  </span></span><span
style='font-size:12.0pt;font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>J</span></span><span
style='font-size:12.0pt'><span style='mso-spacerun:yes'>  </span>Next, you can
avoid constructs that require deep recursion.<span style='mso-spacerun:yes'> 
</span>Quantifying a group is one such construct.<span
style='mso-spacerun:yes'>  </span>So for instance, this pattern recurses
deeply: “</span><span style='font-size:12.0pt;font-family:"Courier New"'>(.)+</span><span
style='font-size:12.0pt'>”, whereas this one does not: “</span><span
style='font-size:12.0pt;font-family:"Courier New"'>.+</span><span
style='font-size:12.0pt'>”.<span style='mso-spacerun:yes'>  </span>Also, you
should compile GRETA with full optimization, making sure to turn on inline
expansion (/Ob1 or /Ob2).<span style='mso-spacerun:yes'>  </span>This
drastically reduces GRETA’s stack usage.<span style='mso-spacerun:yes'> 
</span>Finally, you can use the /STACK switch to the linker to increase your
stack reserve.<span style='mso-spacerun:yes'>  </span>By default, the VC linker
gives executables 1 Mb of stack reserve.<span style='mso-spacerun:yes'> 
</span>By contrast, the version of perl.exe that I have (from ActiveState) has
a whopping 16 Mb of stack reserve.<span style='mso-spacerun:yes'>  </span>For
most situations, 1 Mb is plenty, but if you allow deeply recursive patterns to
match long strings, then you might want to bump your stack reserve up to 2 or 4
Mb.<span style='mso-spacerun:yes'>  </span>With 4 Mb of stack, you can match a
deeply recursive pattern against a string of 35,000 characters without
overflowing your stack.<o:p></o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoCommentText><span style='font-size:12.0pt'>Finally, if you are
still concerned about stack overflows, you can use the “safe” mode to match
patterns.<span style='mso-spacerun:yes'>  </span>When in safe mode, pattern
matching is done using an iterative algorithm, eliminating the possibility of
stack overflows.<span style='mso-spacerun:yes'>  </span>Safe mode is slower,
however.<span style='mso-spacerun:yes'>  </span>See <a href="#_Matching_Modes">Matching
Modes</a> for more information.<o:p></o:p></span></p>

<h2><a name="_Toc39890921">DBCS</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>The regular expression
engine is not DBCS-aware.<span style='mso-spacerun:yes'>  </span>You can use
only fixed-width character sets (that is, ANSI and UNICODE).<span
style='mso-spacerun:yes'>  </span>Sorry.<o:p></o:p></span></p>

<h2><a name="_Toc39890922">STL</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>This regular expression
package makes heavy use of STL (The Standard Template <st1:PersonName w:st="on">Library</st1:PersonName>).<span
style='mso-spacerun:yes'>  </span>STL is available in VC5 and higher.<span
style='mso-spacerun:yes'>  </span>If you are not currently using STL in your
projects (why not?!) you may have to make some modifications to your build
settings to use this package.<span style='mso-spacerun:yes'>  </span>If you are
using the NT build environment, you should add the line “</span><span
style='font-size:12.0pt;font-family:"Courier New"'>USE_STL=1</span><span
style='font-size:12.0pt'>” to your sources file.<span
style='mso-spacerun:yes'>  </span>If you are building in VC, you may need to
explicitly link to one of the STL libraries (msvcprt.lib or libcp.lib, or their
debug equivalents).<o:p></o:p></span></p>

<h2><a name="_Toc39890923"></a><a name="_VC7_and_Managed_Code"></a><span
style='mso-bookmark:_Toc39890923'>VC7 and Managed Code</span></h2>

<p class=MsoNormal>If you are compiling GRETA under VC7, and you care about
speed, you should not compile the code with managed extensions turned on.<span
style='mso-spacerun:yes'>  </span>I have found that the performance of the
regex engine degrades badly with managed code.<span style='mso-spacerun:yes'> 
</span>You should compile GRETA as unmanaged code into a separate library, and
then link the lib to your managed app.</p>

<h2><a name="_Toc39890924"></a><a name="_Template_Instantiation"></a><span
style='mso-bookmark:_Toc39890924'>Template Instantiation</span></h2>

<p class=MsoNormal style='page-break-after:avoid'>I’ve needed to instantiate
the <span style='font-family:"Courier New"'>basic_rpattern</span> classes I
thought would be most useful.<span style='mso-spacerun:yes'>  </span>By
default, only the classes necessary to perform Perl-style pattern matches on
strings of type <span style='font-family:"Courier New"'>TCHAR</span> are
instantiated.<span style='mso-spacerun:yes'>  </span>If you would like to do
pattern matching on both <span style='font-family:"Courier New"'>char</span>
and <span style='font-family:"Courier New"'>wchar_t</span> strings, then
compile with <span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><a href="#_REGEX_WIDE_AND_NARROW">REGEX_WIDE_AND_NARROW</a></span>
defined.<span style='mso-spacerun:yes'>  </span>Note that this will make your
code twice as big.<span style='mso-spacerun:yes'>  </span>See the section <span
style='font-family:"Courier New"'><a href="#_REGEX_TO_INSTANTIATE">REGEX_TO_INSTANTIATE</a></span>
to find out how to have finer control over the template instantiation.<span
style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal style='page-break-after:avoid'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='page-break-after:avoid'>By default, the Perl syntax
module is compiled, and the POSIX syntax is not.<span
style='mso-spacerun:yes'>  </span>If you want to use the POSIX syntax, then
define <span style='font-family:"Courier New"'><a href="#_REGEX_POSIX">REGEX_POSIX</a></span>.<span
style='mso-spacerun:yes'>  </span>If you don’t plan on using Perl syntax, you
can turn off Perl template instantiation by defining <span style='font-family:
"Courier New"'><a href="#_REGEX_NO_PERL">REGEX_NO_PERL</a></span>.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If you have defined your own syntax module that you want to
use with the <span style='font-family:"Courier New"'>rpattern</span> class,
then you need to do something fancier.<span style='mso-spacerun:yes'> 
</span>You can set the <span style='font-family:"Courier New"'><a
href="#_REGEX_TO_INSTANTIATE">REGEX_TO_INSTANTIATE</a> </span>macro to null (<span
style='font-family:"Courier New"'>-DREGEX_TO_INSTANTIATE=</span>) and provide your
own explicit instantiations at the bottom of regexpr2.cpp, using the template
parameters of your choosing.<span style='mso-spacerun:yes'>  </span>Or you can <span
style='font-family:"Courier New"'>#include “regexpr2.cpp”</span> and use
implicit instantiation.<span style='mso-spacerun:yes'>  </span>If you do this,
you should also set <span style='font-family:"Courier New"'><a
href="#_REGEX_TO_INSTANTIATE">REGEX_TO_INSTANTIATE</a></span> to null.<span
style='mso-spacerun:yes'>  </span>But be aware of how many template
instantiations you have, because each additional instantiation will greatly
increase the size of your compiled code.</p>

<h2><a name="_Toc39890925">Contact Information</a></h2>

<p class=MsoCommentText><span style='font-size:12.0pt'>You should send bug
reports and feature requests to me, <a
href="mailto:ericne@microsoft.com?subject=greta%20gripe">Eric Niebler</a>.<span
style='mso-spacerun:yes'>  </span>I’ll get to them as soon as I can.<o:p></o:p></span></p>

<b><span style='font-size:16.0pt;font-family:Arial;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:16.0pt;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE'><br clear=all style='page-break-before:always'>
</span></b>

<h1><a name="_Toc39890926">Appendix 1: History</a></h1>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="03" Day="09" Month="6" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>6/09/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Patterns that begin with a
  string literal now use the Boyer-Moore algorithm to limit the search space,
  resulting in huge perf wins for some patterns.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="03" Day="03" Month="6" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>6/03/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>GRETA now builds on VC6 again
  &lt;sigh&gt;. <br>
  Added 1-char look-ahead to groups and alternates, greatly speeding up some
  patterns.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date ls="trans" Month="5" Day="10" Year="03"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/10/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Modified GRETA so it builds in
  the NT / CoReXT build environment (that is, with the VC6 STL headers). <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="03" Day="5" Month="5" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/5/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Added split().<br>
  10% perf win across the board. <br>
  Fixed bug with VC8’s debug iterators. <br>
  Reduced memory footprint of charsets by 20%.<br>
  Made match_results/subst_results/split_results template on allocator. <br>
  Miscellaneous code clean-up. <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="03" Day="29" Month="4" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/29/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Make GRETA work with debug
  iterators. <br>
  basic_rpattern::swap wasn’t swapping m_invisible_groups; now it does.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2003" Day="2" Month="2" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>2/2/03</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Use pseudo-vtables in
  hetero_stack to increase exception safety when pushing/popping objects with
  non-trivial destructors. <br>
  Use Instantiator to move more implementation out of the headers.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="3" Month="11"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>11/3/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Use Instantiator idiom for
  separate compilation of templates.<br>
  Minor performance tweaks.<br>
  Miscellaneous code clean-up.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="11" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/11/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Remove implementation-dependent
  code that relied on STL containters accepting allocators with per-instance
  state.<span style='mso-spacerun:yes'>  </span>(Hence, the REGEX_NO_ALLOCATOR
  macro is no longer needed.)<br>
  Use of singly-linked lists reduces memory footprint of compiled patterns.<br>
  Miscellaneous code clean-up, resulting in almost 200 fewer lines of code.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="11" Month="6"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>6/11/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Move implementation details into
  internal namespace “detail&quot;.<br>
  Use REGEX_CHAR macro for more correct handling of character literals.<br>
  Miscellaneous code clean-up.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="30" Month="5"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/30/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fixed bad interaction between
  NORMALIZE and EXTENDED flags that was causing “\n” escape sequences to be
  ignored as white-space.<br>
  Fix linking problem when compiling with gcc 3.1 and –O3. <br>
  Included ostream output operator for backrefs in namespace regex.<br>
  Minor performance tweaks.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="22" Month="5"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/22/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fixed some compile problems.<br>
  Add REGEX_TO_INSTANTIATE macro, which controls exactly which instantiations
  of basic_rpattern you want to create.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="17" Month="5"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/17/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>rpattern can now be instantiated
  with non-const iterators.<br>
  Added typename in all places where the standard requires it.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="16" Month="5"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/16/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>rpattern::set_flags() method has
  gone away.<br>
  Bring back implicit conversion of backref to bool using “safe bool” idiom.<br>
  rpattern object now has copy constructor, assignment operator and
  non-throwing swap(), all of which are exception-safe.<br>
  init() and set_substitution() are now exception-safe.<br>
  hetero_stack now has much faster runtime type checking.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="2" Month="5" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>5/02/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>bad_regexpr now inherits from
  std::invalid_argument, as it should.<br>
  Fix alignof struct to not use offsetof().<br>
  Fix potential alignment fault in hetero_stack.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="24" Month="4"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/24/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix NOBACKREFS flag, which has
  been broken since 3/15. Many thanks to Michael Nelte for the bug report.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="22" Month="4"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/22/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Make heterogeneous stack
  exception safe and more generally useful.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="10" Month="4"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/10/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix linker error caused by 4/8
  change. <br>
  Compiles and runs on VC7.1.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="8" Month="4" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/8/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Safer alignment handling in
  unsafe_stack.<br>
  Relaxed the iterator requirements to the match/count/substitute methods. Any
  iterator will now be accepted as long as it is convertible to the rpattern’s
  const_iterator type.<br>
  Implemented template instantiation folding to save space in the executable
  image (disabled by default for backward compatibility). See <a
  href="#_REGEX_FOLD_INSTANTIATIONS">REGEX_FOLD_INSTANTIATIONS</a> for details.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="24" Month="3"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/24/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix potential crashing bug in
  unsafe_stack. Only safe mode is affected.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="15" Month="3"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/15/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Retarget the code for VC7. <br>
  basic_rpattern_c and basic_match_results_c are no longer needed, and are
  marked deprecated. <br>
  The implicit conversion from a backref to a bool is deprecated. <br>
  subst_results now inherits directly from match_results.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="6" Month="3" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/6/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Faster implementation of
  unsafe_stack resulting in an overall 10% perf improvement in “safe” mode.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="28" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/28/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Some fixes for gcc 3.0.3.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:22'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="25" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/25/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>20% performance improvement in
  character set matching.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:23'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="23" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/23/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix VC7 build problem with the
  forward declaration of _resetstkoflw.<span style='mso-spacerun:yes'> 
  </span>Thanks to Steve West for the suggested fix.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:24'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2002" Day="17" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/17/02</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Various portability fixes.
  Compiles with gcc-2.96 with STLPort.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:25'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="5" Month="12"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>12/5/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Compiles cleanly on VC6 with /W4
  and on VC7 with /W4 and /Wp64.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:26'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="29" Month="11"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>11/29/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>GLOBAL match/substitute
  operations with patterns that match zero-length substrings are now handled as
  they are in Perl. <br>
  Performance work on safe mode.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:27'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="26" Month="11"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>11/26/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Finally, a fix for the infamous
  Repeated Pattern Matching Zero-Length Substring bug.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:28'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="16" Month="11"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>11/16/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Big perf improvement for
  quantified literals and character sets. <br>
  Add “safe mode,” a stack-conservative, iterative (slow) way to match
  patterns.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:29'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="30" Month="10"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>10/30/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Statically initialize the Perl
  syntax look-up tables to prevent global rpattern objects from using the
  tables before they are initialized. <br>
  Do away with pointless exception specifications.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:30'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="5" Month="10"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>10/5/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Use group extent information to
  make lookahead and lookbehind assertions and independent subexpressions more
  efficient in both time and (stack) space.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:31'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="27" Month="9"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>9/27/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix a bug when matching a
  zero-width pattern (e.g. /^\s*$/) to an empty std::string.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:32'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="20" Month="9"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>9/20/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Add nathann’s debug heap
  support.<br>
  Trap EXCEPTION_STACK_OVERFLOW and reset the guard page. <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:33'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="12" Month="9"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>9/12/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix AV when trying to match
  against an uninitialized std::string.<br>
  Fix compile problem on IA64. <br>
  Fix alignment fault on IA64 (thanks to nathann for debugging this).<br>
  Backreferences to nonexistent groups now generates an error. <br>
  Code clean up / small reduction in stack usage.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:34'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="5" Month="9" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>9/5/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Add conditional subexpressions
  a-la Perl.<br>
  Fix potential memory leak when parsing invalid character sets with
  REGEX_NO_ALLOCATOR defined.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:35'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="31" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/31/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix backtracking bug in
  non-greedy group quantifiers.<br>
  Null character is allowed as lower bound of range in charset.<br>
  Major improvements in Perl compliance:<br>
  - Add (?#...) comment group. <br>
  - Add Perl /x modifier for non-significant white space in patterns.<br>
  - Add Perl escape sequences \e, \777, \xFF, \cC.<br>
  - backrefs in patterns can refer to enclosing groups<br>
  Add experimental (?R) extension for recursive patterns.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:36'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto;tab-stops:1.0in'><st1:date Year="2001" Day="21"
  Month="8" ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:
   Verdana'>8/21/01</span></st1:date><span style='font-size:10.0pt;font-family:
  Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Fix bug in nested POSIX-style
  character sets.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:37'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="20" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/20/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Use small-object allocator to
  speed up pattern compilation.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:38'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="15" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/15/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  style='font-size:10.0pt;font-family:Verdana'>Complete overhaul of the
  interface. <br>
  Remove regexpr class; add match_results/subst_results. <br>
  Intrinsic charsets (\w, \d, \s) respect locale settings. <br>
  CSTRINGS flag functionally replaced by rpattern_c object.<br>
  Custom intrinsic charsets are managed by syntax module. <br>
  Compiles and runs on Linux (STLport-4.0, gcc 2.96).<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:39'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="31" Month="7"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>7/31/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Big
  performance improvements. <br>
  Fix for STATIC_RPATTERN macro.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:40'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="9" Month="7" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>7/9/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Add
  negative posix charsets like [:^alpha:]. <br>
  Make posix charsets play nice with user-defined intrinsic charsets.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:41'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="17" Month="4"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/17/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Remove
  vertical tab character (‘\v’) from \s intrinsic character set.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:42'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="10" Month="3"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/10/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Explicitly
  zero Perl syntax look-up tables.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:43'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="31" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/31/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Fix
  assert when parsing certain invalid patterns.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:44'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="25" Month="1"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/25/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Fix
  AV when reinitializing an rpattern.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:45'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2001" Day="5" Month="1" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>1/5/01</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Remove
  platform-dependent assumption that string iterators are char*.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:46'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="13" Month="10"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>10/13/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Compiles
  and runs with VC7.<br>
  Add new Perl \z assertion.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:47'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="14" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/14/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Use
  pattern width analysis to optimize matching.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:48'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="10" Month="8"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>8/10/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Add
  lookbehind assertions, which can be arbitrarily complicated (Perl only allows
  fixed-width lookbehinds).<br>
  Allow posix-style nested charsets, like [:alpha:] (Perl 5.6 negative posix
  charsets like [:^alpha:] not supported).<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:49'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="18" Month="4"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/18/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Include
  basic POSIX syntax module.<br>
  Don't allow uninitialized backrefs to match the empty string.<br>
  ] doesn't close a character class if it is the first character in the class.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:50'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="27" Month="3"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/27/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Fix
  leak when parsing invalid substitution strings.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:51'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="22" Month="3"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>3/22/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Support
  quotemeta (\Q and \E) in pattern and substitution strings.<br>
  Support upper- and lower-case escape sequences (\L \l \U \u) in substitution
  strings.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:52'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="2000" Day="9" Month="2" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>2/9/00</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>regexpr
  is now template on character type, traits and allocator!<br>
  rpattern is also template on syntax module.<br>
  Fixed bug with ^ when doing global multiline match.<br>
  Fixed problem with $' when doing global substitution.<br>
  Made $ more Perl-like.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:53'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="1999" Day="20" Month="9"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>9/20/99</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Fixed
  bug in Unicode charset matching.<br>
  Performance improvements.<br>
  Allow user-defined intrinsic character sets.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:54'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="1999" Day="23" Month="6"
  ls="trans" w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>6/23/99</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Expanded
  the global match and substitute functionality<br>
  Improved performance of character set matching<br>
  Open source'd it!<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:55'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="1999" Day="4" Month="6" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>6/4/99</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Just
  fixed a memory leak! Get the latest version.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:56;mso-yfti-lastrow:yes'>
  <td width=91 valign=top style='width:68.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.05in;
  mso-margin-bottom-alt:auto'><st1:date Year="1999" Day="1" Month="4" ls="trans"
  w:st="on"><span style='font-size:10.0pt;font-family:Verdana'>4/1/99</span></st1:date><span
  style='font-size:10.0pt;font-family:Verdana'><o:p></o:p></span></p>
  </td>
  <td width=524 valign=top style='width:392.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;margin-right:.5in;
  mso-margin-bottom-alt:auto'><span style='font-size:10.0pt;font-family:Verdana'>Submitted
  to <a href="http://toolbox/"><span style='font-size:12.0pt;font-family:"Times New Roman"'>http://toolbox/</span></a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<b><span style='font-size:16.0pt;font-family:Arial;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:16.0pt;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE'><br clear=all style='page-break-before:always'>
</span></b>

<h1><a name="_Toc39890927">Appendix 2: Implementation Details</a></h1>

<p class=MsoNormal>So, you want to know how GRETA works, huh?<span
style='mso-spacerun:yes'>  </span>Well, it is a hybrid of a standard state
machine and the Interpreter design pattern, as described in <u>Design Patterns</u>,
by Gamma, et al.<span style='mso-spacerun:yes'>  </span>A state machine has
states and transitions in a directed, possibly cyclic, graph.<span
style='mso-spacerun:yes'>  </span>It also has a clear flow from the initial
state to the terminal state.<span style='mso-spacerun:yes'>  </span>It is
generally implemented with a p-code interpreter or with jump tables.<span
style='mso-spacerun:yes'>  </span>The Interpreter pattern, on the other hand,
doesn't deal with states -- it deals with grammar rules.<span
style='mso-spacerun:yes'>  </span>Each rule in your language (e.g. regular
expressions) gets its own polymorphic class, and you parse sentences in your
language into trees of these polymorphic nodes according to your grammar rules.<span
style='mso-spacerun:yes'>  </span>Recognizing sentences in your language (e.g.,
matching a pattern) happens by recursively traversing this tree.</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal>GRETA is somewhere in between these two.<span
style='mso-spacerun:yes'>  </span>It is basically a state machine, but the
states are polymorphic nodes in a graph, and transitions are virtual function
calls between nodes, much like Interpreter.<span style='mso-spacerun:yes'> 
</span>There is one start node, and (essentially) one end node.<span
style='mso-spacerun:yes'>  </span>In between, there are branches and
loops.<span style='mso-spacerun:yes'>  </span>The goal is to find a way to the
end state using only legal transitions.<span style='mso-spacerun:yes'> 
</span>Each node either matches or it doesn't.<span style='mso-spacerun:yes'> 
</span>If it doesn't, it returns false.<span style='mso-spacerun:yes'> 
</span>If it does, it passes execution to the next node in the graph
recursively.<span style='mso-spacerun:yes'>  </span>If there are branches, it
picks one, and if its first guess fails to match (returns false), it tries the
next one.<span style='mso-spacerun:yes'>  </span>The entire execution state
during pattern matching is maintained in local variables on the stack.<span
style='mso-spacerun:yes'>  </span>Since there is no dynamic allocation, it is
very fast.</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal>This approach can actually be as fast/faster that a
traditional p-code state machine.<span style='mso-spacerun:yes'>  </span>With
p-code, to move between states, you have an op-code and you execute a big
switch on your op-code.<span style='mso-spacerun:yes'>  </span>Big switches are
inefficient -- they introduce branches and blow locality out of the water.<span
style='mso-spacerun:yes'>  </span>Compare that to a virtual function call.<span
style='mso-spacerun:yes'>  </span>A couple of indirections and you're executing
the code you want to be executing, with no branches.<span
style='mso-spacerun:yes'>  </span>This is similar to the jump table school of
state machines.<span style='mso-spacerun:yes'>  </span>But jump tables are hard
to write, hard to understand and hard to maintain.<span
style='mso-spacerun:yes'>  </span>With GRETA, the v-tables are the jump tables,
and I let the compiler worry about writing them and maintaining them.</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal>Finally, I use a lot of template tricks to choose branches
at compile time and to turn virtual function calls into inline function
calls.<span style='mso-spacerun:yes'>  </span>(Try <i style='mso-bidi-font-style:
normal'>that</i> with a jump table!)<span style='mso-spacerun:yes'> 
</span>This speeds things up a lot, at the expense of some code bloat.<span
style='mso-spacerun:yes'>  </span>I have an article about this trick in the January
2003 issue of the C/C++ User's Journal.<span style='mso-spacerun:yes'>  </span>You
can read online it here: <a
href="http://www.cuj.com/articles/2003/0301/0301d/0301d.htm?topic=articles">http://www.cuj.com/articles/2003/0301/0301d/0301d.htm?topic=articles</a>.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
